/*!CK:2917520408!*//*1446534854,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["cK6iP"]); }

__d('NotificationSeenState',['NotificationConstants','NotificationUpdates','createObjectFrom'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={},l=1,m=2,n=0,o=l,p=l|m,q=h.PayloadSourceType.INITIAL_LOAD,r={UNSEEN_AND_UNREAD:n,SEEN_BUT_UNREAD:o,SEEN_AND_READ:p};function s(v){var w=[],x=[];Object.keys(v).forEach(function(y){var z=v[y],aa=k[y];k[y]=z;if(aa===undefined){w.push(y);x.push(y);return;}var ba=aa^z;if(ba&l)w.push(y);if(ba&m)x.push(y);});w.length&&i.didUpdateSeenState(w);x.length&&i.didUpdateReadState(x);}i.subscribe('update-notifications',function(v,w){var x=w.nodes;if(!x||!x.length)return;var y=w.payloadsource,z=h.PayloadSourceType,aa=y==z.ENDPOINT,ba={};w.nodes.forEach(function(ca){var da=ca.alert_id;if(!aa||k[da]===undefined)ba[da]=r[ca.seen_state];});s(ba);});i.subscribe('update-seen',function(v,w){if(!w.seenState)return;var x=[],y={};Object.keys(w.seenState).forEach(function(aa){if(!w.seenState[aa]){x.push(aa);return;}var ba=k[aa];if(ba!==undefined)y[aa]=ba|l;});var z=babelHelpers._extends({},j(x,n),y);s(z);});i.subscribe('update-read',function(v,w){if(!w.readState)return;var x=[],y={};Object.keys(w.readState).forEach(function(aa){if(w.readState[aa]){x.push(aa);return;}var ba=k[aa];if(ba!==undefined){y[aa]=ba&~m;}else if(w.payloadsource==q)y[aa]=o;});var z=babelHelpers._extends({},j(x,p),y);s(z);});function t(v){var w=k[v];return w;}var u={isRead:function(v){return t(v)===p;},isSeen:function(v){return t(v)!==n;},getUnseenCount:function(){return u.getUnseenIDs().length;},getUnseenIDs:function(){return Object.keys(k).filter(function(v){return k[v]===n;});},getUnreadCount:function(){return u.getUnreadIDs().length;},getUnreadIDs:function(){return Object.keys(k).filter(function(v){return k[v]!==p;});}};f.exports=u;},null);
__d('NotificaionJewelControllerModuleLoader',['JSResource','NotificationSeenState','NotificationStore','NotificationUpdates'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();c('NotificationSeenState');c('NotificationStore');c('NotificationUpdates');f.exports=h('NotificationJewelController');},null);
__d('NotificationJewelHeaderController',['DOM','Event','NotificationSeenState','NotificationUserActions','NotificationUpdates'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(n,o){'use strict';i.listen(n,'click',function(){var p=j.getUnreadIDs();if(p.length)k.markNotificationsAsRead(p);});l.subscribe('read-state-updated',function(){if(o)h.setContent(o,j.getUnreadCount());});}f.exports=m;},null);
__d('NotificationHiddenState',['NotificationUpdates','NotificationConstants','isEmpty'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={};h.subscribe('update-notifications',function(m,n){var o=n.nodes,p=n.payloadsource;if(p===i.PayloadSourceType.LIVE_SEND&&o&&o.length){var q={};o.forEach(function(r){var s=r.alert_id;if(k[s])q[s]=false;});if(!j(q)){k=Object.assign(k,q);h.didUpdateHiddenState(Object.keys(q));}}});h.subscribe('update-hidden',function(m,n){if(n.hiddenState){k=Object.assign(k,n.hiddenState);h.didUpdateHiddenState(Object.keys(n.hiddenState));}});var l={isHidden:function(m){if(k[m])return k[m];return false;}};f.exports=l;},null);
__d('NotificationList.react',['NotificationConstants','NotificationHiddenState','NotificationSeenState','NotificationStore','NotificationUpdates','NotificationUserActions','React','getObjectValues','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q=n.PropTypes,r=h.PayloadSourceType.LIVE_SEND,s=n.createClass({displayName:'NotificationList',propTypes:{businessID:q.string,hasEverBeenOpened:q.bool,maxHeight:q.number,negativeTracking:q.object,paused:q.bool,tracking:q.string,useChevron:q.bool,chevronType:q.string,numPerPage:q.number.isRequired,listRenderer:q.func.isRequired,upsell:q.object},getInitialState:function(){this._currentlyFetching=false;this._pendingNotifs={};this._shouldScroll=false;return {canFetchMore:true,notifs:{},hiddenState:{},readState:{},showingChevron:false};},componentWillMount:function(){k.setBusinessID(this.props.businessID);this._subscriptions=[l.subscribe('notifications-updated',(function(t,u){if(u.source==r&&!p(u.updates)){this._shouldScroll=true;if(this.props.paused!==false)this._pendingNotifs=babelHelpers._extends({},this._pendingNotifs,u.updates);return;}this._fetchAndUpdate(k.getCount());}).bind(this)),l.subscribe(['hidden-state-updated','read-state-updated'],(function(t,u){if(t=='hidden-state-updated'){if(u.source!==r||!this.props.paused){var v={};Object.keys(u.updates).forEach(function(x){v[x]=i.isHidden(x);});this.setState({hiddenState:babelHelpers._extends({},this.state.hiddenState,v)});}}else{var w={};Object.keys(u.updates).forEach(function(x){w[x]=j.isRead(x);});this.setState({readState:babelHelpers._extends({},this.state.readState,w)});}}).bind(this))];},componentWillUnmount:function(){if(this._subscriptions){while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();this._subscriptions=null;}},_getNotifsWithCurrentOrder:function(t){var u=Object.keys(this.state.notifs),v=Object.keys(t).filter((function(x){return !this.state.notifs[x];}).bind(this));u=u.concat(v);var w={};u.forEach((function(x){if(this._pendingNotifs[x]){if(this.state.notifs[x])w[x]=this.state.notifs[x];}else w[x]=t[x];}).bind(this));return w;},_fetchAndUpdate:function(t){this._currentlyFetching=true;k.getNotifications(t,(function(u){var v=p(this._pendingNotifs)?u:this._getNotifsWithCurrentOrder(u),w={},x={};o(v).forEach(function(y){var z=y.alert_id;if(!this.state||!this.state.readState[z])w[z]=j.isRead(z);if(!this.state||!this.state.hiddenState[z])x[z]=i.isHidden(z);});this._currentlyFetching=false;this.setState({notifs:v,canFetchMore:k.canFetchMore()||k.getCount()!=Object.keys(v).length,readState:babelHelpers._extends({},this.state.readState,w),hiddenState:babelHelpers._extends({},this.state.hiddenState,x)});}).bind(this));},_fetchAndUpdateAll:function(){var t={};Object.keys(this._pendingNotifs).forEach((function(u){var v=i.isHidden(u);if(v!=this.state.hiddenState[u])t[u]=i.isHidden(u);}).bind(this));if(!p(t))this.setState({hiddenState:babelHelpers._extends({},this.state.hiddenState,t)});this._pendingNotifs={};this._fetchAndUpdate(k.getCount());},_fetchNextSet:function(){if(!this._currentlyFetching){var t=Object.keys(this.state.notifs).length;this._fetchAndUpdate(t+this.props.numPerPage);}},_onScrollAndUpdate:function(t){if(this._currentlyFetching||!this.state.canFetchMore)return;if(t)this._fetchNextSet();},_onChevronShow:function(){this.setState({showingChevron:true});},_onChevronHide:function(){this.setState({showingChevron:false});},_updateNotifInContainer:function(t){if(t.length>this.props.numPerPage){this._fetchAndUpdate(t.length);}else this._fetchNextSet();return;},componentDidUpdate:function(t){var u=j.getUnseenIDs();if(!p(this._pendingNotifs))u=u.filter((function(v){return !this._pendingNotifs[v];}).bind(this));if(u.length&&this.props.paused)m.markNotificationsAsSeen(u);if(!t.hasEverBeenOpened&&this.props.hasEverBeenOpened)this._updateNotifInContainer(u);if(t.paused&&!this.props.paused){this._shouldScroll=false;setTimeout(this._fetchAndUpdateAll,0);return;}},render:function(){var t=this.props.listRenderer;return (n.createElement(t,{hasEverBeenOpened:this.props.hasEverBeenOpened,paused:this.props.paused,tracking:this.props.tracking,negativeTracking:this.props.negativeTracking,shortenTimestamp:this.props.shortenTimestamp,businessID:this.props.businessID,maxHeight:this.props.maxHeight,useChevron:this.props.useChevron,chevronType:this.props.chevronType,notifs:this.state.notifs,afterScroll:this._onScrollAndUpdate,onChevronShow:this._onChevronShow,onChevronHide:this._onChevronHide,canFetchMore:this.state.canFetchMore,hiddenState:this.state.hiddenState,readState:this.state.readState,showingChevron:this.state.showingChevron,shouldScroll:this._shouldScroll,upsell:this.props.upsell||null,isRHC:this.props.isRHC}));}});f.exports=s;},null);
__d('NotificationListPropTypes',['React'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=h.PropTypes,j={negativeTracking:i.object,tracking:i.string,useChevron:i.bool,chevronType:i.string,notifs:i.object,afterScroll:i.func,onChevronShow:i.func,onChevronHide:i.func,canFetchMore:i.bool,hiddenState:i.object,readState:i.object,showingChevron:i.bool,paused:i.bool,maxHeight:i.number,shouldScroll:i.bool,upsell:i.object};f.exports=j;},null);
__d('FlexibleBlock.react',['LeftRight.react','React','cx','invariant','keyMirror'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=l({left:true,right:true});function n(p){!(p.flex&&p.flex in o.FLEX)?k(0):undefined;!(p.children&&p.children.length===2)?k(0):undefined;}var o=i.createClass({displayName:'FlexibleBlock',render:function(){n(this.props);var p,q=this.props.children[0],r=this.props.children[1],s=this.props.flex==m.left,t;if(s){t=q;p=h.DIRECTION.right;}else{t=r;p=h.DIRECTION.left;}var u=i.createElement('div',{className:"_42ef"},t);return (i.createElement(h,babelHelpers._extends({},this.props,{direction:p}),s?u:this.props.children[0],s?this.props.children[1]:u));}});o.FLEX=m;f.exports=o;},null);
__d('NotificationPhotoThumbnail',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(j){if(!j.media||!j.style_list||!j.style_list.length)return null;switch(j.style_list[0]){case 'new_album':case 'album':case 'application':case 'photo':case 'video':case 'video_autoplay':case 'video_inline':return j.media.image;default:return null;}}var i={getThumbnail:function(j,k,l){var m;if(j&&j.length){j.some(function(q){m=h(q);if(m)return true;return false;});if(m)return m;}if(l){var n=l.relevant_comments;if(n&&n.length){var o=n[0].attachments;if(o&&o.length){m=h(o[0]);if(m)return m;}}}if(k){var p=k.attachments;if(p&&p.length)return h(p[0]);}return null;}};f.exports=i;},null);
__d('VideoPermalinkURI',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={isValid:function(i){return h.parse(i)!==null;},parse:function(i){if(this.isValidLegacy(i)){var j=i.getQueryData();if(j.v)return {video_id:j.v,set_token:j.set};return null;}var k=i.getPath();if(k[k.length-1]==='/')k=k.substring(0,k.length-1);var l=k.split('/');if(l.length>=3&&l[2]==='videos')if(l.length===4&&/^\d+$/.exec(l[3])!==null){return {video_id:l[3],set_token:null};}else if(l.length===5&&/^\d+$/.exec(l[4])!==null)return {video_id:l[4],set_token:l[3]};return null;},isValidLegacy:function(i){var j=i.getPath();if(j[j.length-1]==='/')j=j.substring(0,j.length-1);if(j==='/photo.php'||j==='/force_photo/photo.php'||j==='/photo'||j==='/force_photo/photo/index.php'||j==='/photo/index.php'||j==='/force_photo/photo'||j==='/video.php'||j==='/video/video.php')return true;return false;}};f.exports=h;},null);
__d('NotificationURI',['BusinessURI.brands','URI','isFacebookURI','VideoPermalinkURI'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l={localize:function(m){m=h(m);if(!j(m))return m.toString();var n=m.getSubdomain();return m.getUnqualifiedURI().getQualifiedURI().setSubdomain(n).toString();},snowliftable:function(m){if(!m)return false;m=new i(m);var n=m.getQueryData();return j(m)&&(k.isValid(m)||'fbid' in n);},isVaultSetURI:function(m){return this._areEquals(m,'/ajax/vault/sharer_preview.php');},isAlbumDraftRecoveryDialogURI:function(m){return this._areEquals(m,'/ajax/photos/upload/overlay/');},_areEquals:function(m,n){if(!m)return false;m=new i(m);return j(m)&&m.getPath()===n;},_startsWith:function(m,n){if(!m)return false;m=new i(m);return j(m)&&m.getPath().startsWith(n);}};f.exports=l;},null);
__d('ReadToggle.react',['React','cx','emptyFunction','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l=h.PropTypes,m=h.createClass({displayName:'ReadToggle',propTypes:{isRead:l.bool.isRequired,onClick:l.func,readLabel:l.node,unreadLabel:l.node},getDefaultProps:function(){return {onClick:j};},render:function(){if(this.props.isRead){return (h.createElement('div',{'aria-label':this.props.readLabel,className:this._getClasses(),'data-hover':'tooltip','data-tooltip-alignh':'center',onClick:this.props.onClick}));}else return (h.createElement('div',{'aria-label':this.props.unreadLabel,className:this._getClasses(),'data-hover':'tooltip','data-tooltip-alignh':'center',onClick:this.props.onClick,role:'button',tabIndex:'0'}));},_getClasses:function(){return k(this.props.className,(!this.props.isRead?"_5c9q":'')+(this.props.isRead?' '+"_5c9_":''));}});f.exports=m;},null);
__d('NotificationListItem.react',['AsyncResponse','BizSiteIdentifier.brands','BanzaiLogger','CloseButton.react','Event','FlexibleBlock.react','ImageBlock.react','Keys','List.react','NotificationPhotoThumbnail','NotificationTokens','NotificationURI','NotificationUserActions','React','TextWithEntities.react','ReadToggle.react','Timestamp.react','VaultBoxURI','XUIButton.react','PopoverMenu.react','ReactXUIMenu','cx','invariant','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){if(c.__markCompiled)c.__markCompiled();var fa=ba.Item;function ga(ja,ka){return u.createElement('span',{className:'fwb'},ja);}function ha(ja){return !!(ja&&ja.id&&!ja.is_facebook_app);}var ia=u.createClass({displayName:'NotificationListItem',getInitialState:function(){return {showingOptions:false,negativeFeedbackConfirmation:null,canReportAsSpam:false,spamReportConfirmation:null,sendingFeedback:false,mayUndoHide:false,notifOptionConfirmation:null,isBizSite:i.isBizSite()};},_onKeyDownItem:function(ja){if(l.getKeyCode(ja.nativeEvent)==o.RETURN)this._markItemRead();},_markItemReadIfUnreadFromReadButton:function(){if(!this.props.isRead)t.setNextIsFromReadButton(true);this._markItemReadIfUnread();},_markItemReadIfUnread:function(){!this.props.isRead&&this._markItemRead();},_markItemRead:function(){t.markNotificationsAsRead([this.props.alert_id]);},_onFeedbackError:function(ja){h.defaultErrorHandler(ja);this.setState({sendingFeedback:false});},_onHideSuccess:function(ja){var ka=ja.getPayload();!ka.confirmation?da(0):undefined;this.setState({negativeFeedbackConfirmation:ka.confirmation,canReportAsSpam:ka.canReportAsSpam,sendingFeedback:false,showingOptions:true});},_onHideAppSuccess:function(ja){var ka=ja.getPayload(),la=ka.confirmation,ma=ka.canReportAsSpam;!la?da(0):undefined;this.setState({negativeFeedbackConfirmation:la,canReportAsSpam:ma,mayUndoHide:true,sendingFeedback:false,showingOptions:true});},_onSpamReportSuccess:function(ja){var ka=ja.getPayload().spamReportConfirmation;this.setState({negativeFeedbackConfirmation:null,spamReportConfirmation:ka,sendingFeedback:false});},_onHide:function(){t.markNotificationAsHidden(this.props.alert_id,this._onHideSuccess,this._onFeedbackError);this.setState({sendingFeedback:true,mayUndoHide:true});},_onShowSuccess:function(){this.setState({notifOptionConfirmation:null,negativeFeedbackConfirmation:null,sendingFeedback:false,showingOptions:false});},_onShow:function(){var ja=this.props.negative?this.props.negative.subscription_level:null;t.markNotificationAsVisible(this.props.alert_id,ja,this._onShowSuccess,this._onFeedbackError);this.setState({sendingFeedback:true});},_onReportSpam:function(){t.markNotificationAsSpam(this.props.alert_id,this._onSpamReportSuccess,this._onFeedbackError);this.setState({sendingFeedback:true});},_markAppAsHidden:function(){t.markAppAsHidden(this.props.alert_id,this.props.application.id,this._onHideAppSuccess,this._onFeedbackError);this.setState({sendingFeedback:true});},_markAppAsVisible:function(){t.markAppAsVisible(this.props.alert_id,this.props.application.id,(function(){this.setState({negativeFeedbackConfirmation:null,sendingFeedback:false,showingOptions:false,mayUndoHide:false});}).bind(this),this._onFeedbackError);this.setState({sendingFeedback:true});},_renderAttachedImage:function(ja){if(ja)return (u.createElement('img',{src:ja.uri,className:"_42td",'aria-hidden':true}));return u.createElement('span',null);},_getModifiedTrackingString:function(ja){return JSON.stringify(babelHelpers._extends({},JSON.parse(this.props.tracking),ja));},_onClickCloseButton:function(){if(this.props.useChevron){this.showCloseOptionOnMenuClose=true;}else this.setState({showingOptions:true});},_onCancelNegativeFeedback:function(){this.setState({showingOptions:false});},_getChevron:function(){if(!this.props.menu_options.length)return null;var ja="_1_0c"+(' '+"_55m9")+(this.props.chevronType==='persistent'?' '+"_51v8":''),ka=u.createElement(ba,null,this.props.menu_options?this.props.menu_options.map((function(ma){return (u.createElement(fa,{onclick:(function(){this._onClickNotifOption(ma.server_action);}).bind(this),key:ma.client_action+ma.server_action},u.createElement('div',{className:"_3-y-"},ma.text),u.createElement('div',{className:"_3-y_"},ma.subtext)));}).bind(this)):null),la=u.createElement('a',null,u.createElement(aa,{alignh:'right',menu:ka,className:ja,onShow:this._onChevronShow,onHide:this._onChevronHide},u.createElement('div',{className:"_1_0d"})));return la;},shouldComponentUpdate:function(ja,ka){return (this.props.visible!==ja.visible||this.props.isRead!==ja.isRead||this.props.timestamp!==ja.timestamp||this.props.paused!==ja.paused||this.state.showingOptions!==ka.showingOptions||this.state.sendingFeedback!==ka.sendingFeedback||this.state.canReportAsSpam!==ka.canReportAsSpam||this.state.spamReportConfirmation!==ka.spamReportConfirmation);},componentWillReceiveProps:function(ja){if(this.props.paused&&!ja.paused&&!this.props.visible&&this.state.mayUndoHide)this.setState({mayUndoHide:false});},_onChevronHide:function(){this.props.onChevronHide();this._logChevronEvent('close');if(this.showCloseOptionOnMenuClose){this.showCloseOptionOnMenuClose=false;this._turnOff();}},_turnOff:function(){var ja=ha(this.props.application)?this._markAppAsHidden:this._onHide;ja();},_onChevronShow:function(){this.props.onChevronShow();this._logChevronEvent('open');},_logChevronEvent:function(ja){var ka={event:ja,notif_type:this.props.notif_type,notif_id:parseInt(r.untokenizeIDs([this.props.alert_id])[0],10)};j.log('NotifJewelMenuLoggerConfig',ka);},_onNotifOptionSuccess:function(ja){this.setState({showingOptions:true,sendingFeedback:false,notifOptionConfirmation:ja});},_onClickNotifOption:function(ja){this.setState({sendingFeedback:true,mayUndoHide:true});t.sendNotifOption(this.props.alert_id,this._onNotifOptionSuccess,this._onFeedbackError,ja);},_undoNotifOption:function(ja){this.setState({sendingFeedback:true});t.undoNotifOption(this.props.alert_id,this._onShowSuccess,this._onFeedbackError,ja);},render:function(){if(!this.props.visible&&!this.state.mayUndoHide)return u.createElement('li',{className:"_4_62"});var ja=this.props.negative,ka=this.props.negativeTracking,la="_33c"+(!this.props.isRead?' '+"_4af":'')+(this.state.showingOptions?' '+"_4ag":'')+(this.state.sendingFeedback?' '+"_4m8s":'');if(this.state.negativeFeedbackConfirmation){var ma=this.state.negativeFeedbackConfirmation,na=null,oa=null;if(this.state.canReportAsSpam)if(!this.props.useChevron){na=u.createElement('span',null,u.createElement('span',{className:'mhs'},'Â·'),u.createElement('a',{href:'#',onClick:this._onReportSpam},ea._("Report app for spam")));}else oa=u.createElement(p,{border:'none',spacing:'small',className:"_1v4c"},u.createElement('li',null,u.createElement('a',{href:'#',onClick:this._onReportSpam,className:'mls'},ea._("Report app for spam"))));var pa=ha(this.props.application)?this._markAppAsVisible:this._onShow,qa=!this.props.useChevron?u.createElement('a',{href:'#',onClick:pa,className:'mls'},ea._("Undo")):null;return (u.createElement('li',{className:la,'data-gt':this.props.tracking},u.createElement('div',{className:"_4ai"},u.createElement(v,{interpolator:ga,ranges:ma.ranges,aggregatedranges:ma.aggregated_ranges,text:ma.text}),qa,na),oa));}var ra=this.state.spamReportConfirmation;if(ra)return (u.createElement('li',{className:la,'data-gt':this.props.tracking},u.createElement('div',{className:"_4ai"},u.createElement(v,{interpolator:ga,ranges:ra.ranges,aggregatedranges:ra.aggregated_ranges,text:ra.text}))));if(this.state.notifOptionConfirmation){ma=this.state.notifOptionConfirmation;return (u.createElement('li',{className:la,'data-gt':this.props.tracking},u.createElement('div',{className:"_4ai"},u.createElement(v,{interpolator:ga,ranges:ma.ranges,aggregatedranges:ma.aggregated_ranges,text:ma.text&&ma.text.text?ma.text.text:''}),u.createElement('a',{href:'#',onClick:(function(){this._undoNotifOption(ma.undo_action);}).bind(this),className:'mls'},ea._("Undo"))),u.createElement(p,{border:'none',spacing:'small',className:"_1v4c"},ma.follow_up_options.map?ma.follow_up_options.map((function(pb){return (u.createElement('li',{key:pb.client_action+pb.server_action},u.createElement('a',{onClick:(function(){this._onClickNotifOption(pb.server_action);}).bind(this),href:'#',className:'mls'},pb.subtext)));}).bind(this)):null)));}if(this.state.showingOptions&&!this.props.useChevron){var sa=ha(this.props.application)?this._markAppAsHidden:this._onHide;return (u.createElement('li',{className:la,'data-gt':this.props.tracking},u.createElement('div',{className:"_4ai"},u.createElement('div',null,u.createElement(v,{interpolator:ga,ranges:ja.confirm_question.ranges,aggregatedranges:ja.confirm_question.aggregated_ranges,text:ja.confirm_question.text})),u.createElement('div',{className:'mts'},u.createElement(z,{'data-gt':this._getModifiedTrackingString(ka.confirm),href:{url:'#'},label:ja.turn_off,use:'confirm',onClick:sa,disabled:this.state.sendingFeedback}),u.createElement(z,{'data-gt':this._getModifiedTrackingString(ka.cancel),href:{url:'#'},label:ea._("Keep On"),onClick:this._onCancelNegativeFeedback,disabled:this.state.sendingFeedback})))));}var ta=null;if(this.props.title)ta=u.createElement(v,{interpolator:ga,ranges:this.props.title.ranges,aggregatedranges:this.props.title.aggregated_ranges,text:this.props.title.text,renderEmoji:true,renderEmoticons:true});var ua=null,va=null;if(ja){var wa=this._onClickCloseButton,xa;xa=this._getModifiedTrackingString(ka.click);var ya="_4ah"+(' '+"_55m9");ua=u.createElement(k,{className:ya,'data-gt':xa,size:'medium',tooltip:ja.button_tooltip,onClick:wa,ref:'closeButton'});}var za=s.localize(this.props.url),ab=null;if(!this.props.noPhotoPreviews)ab=q.getThumbnail(this.props.attachments,this.props.attached_story,this.props.feedback_context);var bb=ab&&s.snowliftable(za),cb=s.isVaultSetURI(za),db=s.isAlbumDraftRecoveryDialogURI(za),eb=(this.props.useChevron?"_55ma":'')+(' '+"_55m9"),fb=u.createElement(w,{className:eb,isRead:!!this.props.isRead,onClick:this._markItemReadIfUnreadFromReadButton,readLabel:ea._("Read"),unreadLabel:ea._("Mark as Read")}),gb=null;if(this.props.useChevron){ua=null;gb=this._getChevron();}var hb=bb||cb||db?za:this.props.ajaxify_url,ib=null,jb=null,kb=cb?y.getSyncedTabURI().toString():za;if(bb){ib='theater';}else if(db){ib='async-post';}else if(cb||hb)ib='dialog';var lb=null,mb=this.props.actors[0];if(mb)lb={backgroundImage:'url('+mb.profile_picture.uri+')'};var nb=false;this.props.attachments.forEach(function(pb){if(nb)return;nb=pb.style_list.indexOf('notification_target')>=0||pb.style_list.indexOf('question')>=0;if(nb)return;});var ob=u.createElement('div',null,fb,ua,gb);return (u.createElement('li',{className:la,'data-gt':this.props.tracking,onMouseLeave:va},u.createElement('div',{className:'anchorContainer'},u.createElement('a',{href:kb,ajaxify:hb,className:"_33e"+(this.props.useChevron?' '+"_1_0e":''),rel:ib,onClick:jb,onMouseDown:this._markItemRead,onKeyDown:this._onKeyDownItem},u.createElement(n,null,u.createElement('span',{style:lb,className:(!this.props.isNotifsPage?"_33h":'')+(this.props.isNotifsPage?' '+"_12u1":'')}),u.createElement(m,{flex:m.FLEX.left},u.createElement('div',{className:"_4l_v"},ta,u.createElement(n,{className:"_33f"+(this.state.isBizSite?' '+"_2g48":'')},u.createElement('img',{className:"_10cu",src:this.props.icon.uri}),u.createElement('span',null,u.createElement(x,{shorten:this.props.shortenTimestamp,time:this.props.timestamp.time,text:this.props.timestamp.text,verbose:this.props.timestamp.verbose,className:"_33g"})))),this._renderAttachedImage(ab)))),ob)));}});f.exports=ia;},null);
__d('NotificationJewelList.react',['Animation','Event','LoadingIndicator.react','NotificationListPropTypes','NotificationListItem.react','React','ReactDOM','ScrollableArea.react','Vector','cx','debounce','fbt','getObjectValues','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();var v=160,w=530,x=40,y=64,z=430,aa=m.createClass({displayName:'NotificationJewelList',propTypes:k,_isLoadingIndicatorVisible:function(){var ba=this.refs.loading;if(!ba)return false;var ca=n.findDOMNode(this.refs.scrollable),da=p.getElementDimensions(ca).y;if(da===0)return false;var ea=p.getElementPosition(ca).y+da,fa=p.getElementPosition(n.findDOMNode(ba)).y;fa-=x;return fa<ea;},_calculateHeight:function(){var ba=p.getViewportDimensions().y,ca=Math.min(this.props.maxHeight||w,ba-v);if(this.props.upsell)return Math.max(ca-y,0);return ca;},_keepOnLoading:function(){if(this.isMounted())this.props.afterScroll(this._isLoadingIndicatorVisible());},_renderItems:function(){return t(this.props.notifs).map((function(ba){var ca=ba.alert_id;return (m.createElement(l,babelHelpers._extends({key:ca,visible:!this.props.hiddenState[ca],isRead:this.props.readState[ca],negativeTracking:this.props.negativeTracking,shortenTimestamp:this.props.shortenTimestamp,useChevron:this.props.useChevron,chevronType:this.props.chevronType,onChevronShow:this.props.onChevronShow,onChevronHide:this.props.onChevronHide,paused:this.props.paused,parent:this},ba)));}).bind(this));},componentDidMount:function(){var ba=n.findDOMNode(this.refs.scrollable);i.listen(window,'resize',r((function(){if(!u(this.props.notifs))new h(ba).to('height',this._calculateHeight()+'px').duration(100).go();}).bind(this)));},componentDidUpdate:function(ba){if(this.props.paused&&!ba.paused)if(this.props.shouldScroll&&this.refs.scrollable)this.refs.scrollable.getArea().scrollToTop(false);setTimeout(this._keepOnLoading,0);},render:function(){var ba=this.props.notifs,ca=null,da=null,ea=z,fa=null;if(!u(ba)){ca=m.createElement('ul',{'data-gt':this.props.tracking},this._renderItems());da=this._calculateHeight();}else if(!this.props.canFetchMore)ca=m.createElement('div',{className:"_572e"},s._("No new notifications"));if(this.props.canFetchMore)fa=m.createElement(j,{color:'white',size:'small',ref:'loading',className:"_33i"});var ga=null;if(this.props.upsell){var ha=this.props.upsell.module;ga=m.createElement(ha,this.props.upsell.props);}var ia="_50-t"+(this.props.showingChevron?' '+"_2iy1":'');return (m.createElement('div',{className:ia},m.createElement(o,{ref:'scrollable',width:ea,height:da,fade:true,persistent:true,onScroll:r(this._keepOnLoading)},ca,fa),ga));}});f.exports=aa;},null);
__d('NotificationJewelListController',['NotificationList.react','NotificationJewelList.react','React','ReactDOM'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m,n){'use strict';this.$NotificationJewelListController1=m;this.$NotificationJewelListController2=n;this.$NotificationJewelListController3=false;this.$NotificationJewelListController4=false;this.$NotificationJewelListController5();}l.prototype.open=function(){'use strict';this.$NotificationJewelListController3=true;this.$NotificationJewelListController5();};l.prototype.pause=function(){'use strict';this.$NotificationJewelListController4=true;this.$NotificationJewelListController5();};l.prototype.unpause=function(){'use strict';this.$NotificationJewelListController4=false;this.$NotificationJewelListController5();};l.prototype.$NotificationJewelListController5=function(){'use strict';k.render(j.createElement(h,{hasEverBeenOpened:this.$NotificationJewelListController3,paused:this.$NotificationJewelListController4,tracking:this.$NotificationJewelListController2.tracking,negativeTracking:this.$NotificationJewelListController2.negativeTracking,shortenTimestamp:this.$NotificationJewelListController2.shortenTimestamp,businessID:this.$NotificationJewelListController2.businessID,maxHeight:this.$NotificationJewelListController2.maxHeight,useChevron:this.$NotificationJewelListController2.useChevron,chevronType:this.$NotificationJewelListController2.chevronType,numPerPage:5,listRenderer:i,upsell:this.$NotificationJewelListController2.upsell||null}),this.$NotificationJewelListController1);};f.exports=l;},null);
__d("XQuickPromotionSimpleLoggingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/qp\/action\/log\/",{qp_id:{type:"Int",required:true},qp_action:{type:"Enum",enumType:1},qp_instance_log_data:{type:"StringToStringMap",defaultValue:{}},qp_event:{type:"String"}});},null,{});
__d('QPRenderer',['$','CSS','XQuickPromotionSimpleLoggingController','AsyncSignal'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=function(q,event,r){var s=j.getURIBuilder().setInt('qp_id',q).setString('qp_event',event).setStringToStringMap('qp_instance_log_data',r).getURI();new k(s,{}).send();},m=function(q,r,s){var t=j.getURIBuilder().setInt('qp_id',q).setEnum('qp_action',r).setStringToStringMap('qp_instance_log_data',s).getURI();new k(t,{}).send();},n=function(q,r,s,t,u,v){p(q,s,h(t),v,function(){if(u)i.hide(r);});},o=function(q,r,s){r.show();l(q,'view',{});r.subscribe('cancel',function(){l(q,'dialog_cancel',{});});for(var t=0;t<s.length;t++){var u=s[t],v=h(u.element_id);p(q,u.action,v,u.instance_log_data,function(){if(u.should_close)r.hide();});if(u.action=='primary')v.focus();}},p=function(q,r,s,t,u){s.addEventListener('click',function(){var v=j.getURIBuilder().setInt('qp_id',q).setEnum('qp_action',r).setStringToStringMap('qp_instance_log_data',t).getURI();new k(v,{}).send();u();});};g.setAction=n;g.setDialogActionsAndShow=o;g.logAction=m;g.logEvent=l;},null);
__d('ContextualHelpSearchController',['Event','AsyncRequest','DOM','CSS','Focus','Input'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=400;function o(){this._token=null;this._timerID=0;this._lastQuery=null;this.typing_listener=null;this.clear_listener=null;this.async_request=null;}Object.assign(o.prototype,{init:function(p,q,r,s,t,u){this.loader=p;this.search_box=q;this.topics_area=r;this.results_area=s;this.clear_button=t;this.typing_listener=h.listen(this.search_box,'keyup',this.setTimer.bind(this));this.clear_listener=h.listen(this.clear_button,'click',this.clearResults.bind(this));if(u==null||u.focusSearchBox==null||u.focusSearchBox)l.set(this.search_box);},source:'contextual_help',clearResults:function(){this.show(this.topics_area);this._lastQuery='';m.reset(this.search_box);l.set(this.search_box);if(this.async_request!==null){this.async_request.abort();this.async_request=null;}k.addClass(this.clear_button,'hidden_elem');},update:function(){var p=m.getValue(this.search_box);if(p===this._lastQuery)return;this._lastQuery=p;if(p===''){this.clearResults();return;}this.show(this.loader);var q={query:p,width:this._width||n,source:this.source};this.async_request=new i('/help/ajax/search/').setData(q).setHandler((function(r){this._update(r);}).bind(this));this.async_request.send();},_update:function(p){this.async_request=null;var q=p.getPayload().results;j.setContent(this.results_area,q);this.show(this.results_area);if(m.getValue(this.search_box)===''){this.clearResults();}else k.removeClass(this.clear_button,'hidden_elem');},setTimer:function(){if(this._timerID!==0)clearTimeout(this._timerID);this._timerID=setTimeout(this.update.bind(this),300);if(this.async_request!=null){this.async_request.abort();this.async_request=null;}},show:function(p){var q=[this.loader,this.topics_area,this.results_area];for(var r=0;r<q.length;r++)k.addClass(q[r],'hidden_elem');k.removeClass(p,'hidden_elem');}});f.exports=o;},null);
__d('JewelQPLogging',['QPRenderer'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=false,j=null,k=false;function l(){if(k)return;if(i&&j){h.logEvent(j.promotion_id,'view',j.instance_log_data?j.instance_log_data:{});k=true;}}var m={onJewelOpened:function(){i=true;l();},updateQPLogData:function(n){j=n;l();}};f.exports=m;},null);
__d('RequestsJewel',['Animation','AccessibilityLogger','Arbiter','AsyncRequest','AsyncSignal','ChannelConstants','CSS','DOM','Event','LinkController','Parent','ScrollableArea','Vector','$','debounce','ge','shield','fbt','JewelQPLogging','requireWeak'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();var ba=null;aa('FriendBrowserCheckboxController',function(ga){return ba=ga;});var ca=530,da=30,ea=160;Object.assign(fa,{instance:null,getInstance:function(){return fa.instance;},replaceJewelTitle:function(ga,ha){o.setContent(u(ga),ha);},updateFromDOM:function(){if(fa.instance)fa.instance.fromDom();},setInitialHeight:function(){if(fa.instance)fa.instance.setHeight();},maybeLoadJewel:function(){if(fa.instance)fa.instance.maybeLoadJewel();}});function fa(ga,ha,ia){'use strict';var ja=ha;if(typeof ha!=='string'){ja=ha.inbox_folder;ia=ha.do_new_mark_read;}fa.instance=this;this.countNew=0;this.jewel=ga;this.jewelFlyoutCase=ga.getRoot();this.jewelFlyout=w('fbRequestsFlyout');this.newCountSpan=w('newRequestCount');this.folder=ja;this.doNewMarkRead=ia;this.openTimestamp=0;this.$RequestsJewel1={};this.$RequestsJewel2=0;this.shouldClearPredictionAssocOnClick=false;var ka=w('requestsMarkReadButton');if(ka)p.listen(ka,'click',x(this.$RequestsJewel3,this));this.jewel.subscribe('marked-seen',x(this.$RequestsJewel4,this));this.jewel.subscribe('closed',x(this.$RequestsJewel5,this));this.jewel.subscribe('updated',this.$RequestsJewel6.bind(this));this.jewel.subscribe('opened',this.$RequestsJewel7.bind(this));q.registerHandler(this.$RequestsJewel8.bind(this));j.subscribe(m.getArbiterType('jewel_requests_add'),this.$RequestsJewel9.bind(this));j.subscribe(m.getArbiterType('jewel_friending_notifs'),this.$RequestsJewel10.bind(this));j.subscribe(m.getArbiterType('jewel_requests_remove_old'),this.$RequestsJewel11.bind(this));j.subscribe(m.getArbiterType('friend_requests_seen'),this.$RequestsJewel12.bind(this));p.listen(this.jewelFlyout,'submit',(function(ma){var na=r.byClass(ma.getTarget(),'objectListItem');if(na){n.removeClass(na,'jewelItemNew');n.addClass(na,'jewelItemResponded');}}).bind(this));var la=o.find(w('fbRequestsJewel'),'a[rel="toggle"]');p.listen(la,'focus',(function(ma){i.logFocusIn();}).bind(this));this.setupScroll();p.listen(window,'resize',v((function(){this.$RequestsJewel13();}).bind(this)));}fa.prototype.setupScroll=function(){'use strict';var ga=o.scry(this.jewelFlyout,'.uiScrollableAreaWrap')[0];if(ga){this.$RequestsJewel14=ga;this.$RequestsJewel15=0;this.$RequestsJewel16=p.listen(ga,'scroll',this.$RequestsJewel17.bind(this),p.Priority.$RequestsJewel18);}};fa.prototype.fromDom=function(){'use strict';o.scry(this.jewelFlyout,'.jewelItemList li.objectListItem').forEach((function(ga){var ha=ga.getAttribute('id');if(ha){var ia=w(ha+'_status'),ja=this.$RequestsJewel19(ha);if(ja.requester)this.$RequestsJewel1[ja.requester]=ha;++this.$RequestsJewel2;}}).bind(this));this.$RequestsJewel20();};fa.prototype.$RequestsJewel21=function(ga){'use strict';var ha=ga.match(/^(\d+)_(\d+)/);return ha?{requester:ha[1],type:ha[2]}:undefined;};fa.prototype.$RequestsJewel19=function(ga){'use strict';var ha=ga?this.$RequestsJewel21(ga):undefined,ia;if(ha&&ha.requester){ia=parseInt(ha.requester,10);if(isNaN(ia))ia=undefined;}var ja;if(ha&&ha.type){ja=parseInt(ha.type,10);if(isNaN(ja))ja=undefined;}return {requester:ia,type:ja};};fa.prototype.$RequestsJewel22=function(){'use strict';if(this.countNew>0)this.countNew-=1;};fa.prototype.$RequestsJewel8=function(ga,event){'use strict';var ha=r.byClass(ga,'jewelItemNew');if(ha&&r.byClass(ha,'fbRequestList')&&r.byClass(ha,'beeperEnabled')){var ia=this.$RequestsJewel21(ha.id);ia&&this.$RequestsJewel4(ia.requester,ia.type);this.$RequestsJewel22();j.inform('jewel/count-updated',{jewel:'requests',count:this.countNew});n.removeClass(ha,'jewelItemNew');}return true;};fa.prototype.$RequestsJewel23=function(){'use strict';return o.scry(this.jewelFlyout,'.uiScrollableArea')[0];};fa.prototype.$RequestsJewel17=function(){'use strict';var ga=o.scry(this.$RequestsJewel14,'.uiMorePager');if(!ga)return;var ha=ga.pop();if(ha){var ia=t.getElementPosition(ha,'viewport').y;if(ia>0)n.addClass(r.byClass(this.$RequestsJewel14,'uiScrollableArea'),'contentAfter');var ja=o.find(ha,'a');if(!ja)return;var ka=t.getElementPosition(ja,'viewport').y;if(ka==this.$RequestsJewel15)return;var la=t.getElementPosition(this.$RequestsJewel14,'viewport').y+t.getElementDimensions(this.$RequestsJewel14).y;if(ka-300<la&&ka>0){this.$RequestsJewel15=ka;var ma=ja.getAttribute('ajaxify');if(ma){new k(ma).setRelativeTo(ja).setStatusElement(r.byClass(ja,'stat_elem')).send();}else ba&&ba.getInstance('jewel').showMore();}}};fa.prototype.$RequestsJewel10=function(ga,ha){'use strict';if(!ha||this.jewel.isOpen())return;if(ha.obj.notif_type!=='friend_confirmed')return;if(w('fbRequestsJewelLoading')){new k().setURI('/ajax/requests/loader/').send();return;}var ia={};ia.reloadcontent=true;new k().setURI('/ajax/requests/loader/').setData(ia).send();};fa.prototype.$RequestsJewel9=function(ga,ha){'use strict';if(!ha)return;var ia=ha.obj.from,ja=ha.obj.suggester,ka=this.$RequestsJewel19(this.$RequestsJewel1[ia]).type,la=ka===19&&!ja;if(!la&&(ka||this.jewel.isOpen()))return;if(w('fbRequestsJewelLoading')){new k().setURI('/ajax/requests/loader/').send();}else{var ma={};ma.reloadcontent=true;new k().setURI('/ajax/requests/loader/').setData(ma).send();}};fa.prototype.$RequestsJewel11=function(ga,ha){'use strict';if(!ha||this.jewel.isOpen()||w('fbRequestsJewelLoading')!==null)return;var ia=this.$RequestsJewel1[ha.obj.from],ja=ia&&w(ia);if(ja){if(n.hasClass(ja,'jewelItemNew')){this.$RequestsJewel22();j.inform('jewel/count-updated',{jewel:'requests',count:this.countNew});}if(!n.hasClass(ja,'jewelItemResponded')){o.remove(ja);delete this.$RequestsJewel1[ha.obj.from];--this.$RequestsJewel2;this.$RequestsJewel20();}}};fa.prototype.$RequestsJewel3=function(){'use strict';this.jewel.markSeen();this.$RequestsJewel24();};fa.prototype.$RequestsJewel4=function(ga,ha){'use strict';var ia=o.scry(this.jewelFlyout,'li');new l('/ajax/gigaboxx/endpoint/UpdateLastSeenTime.php',{folder:this.folder,first_item:ia[0].id}).send();var ja=typeof ga!='undefined'&&typeof ha!='undefined'?{requester:ga,type:ha}:{};this.doNewMarkRead&&new l('/ajax/requests/mark_read/',ja).send();};fa.prototype.$RequestsJewel12=function(ga,ha){'use strict';j.inform('jewel/count-updated',{jewel:'requests',count:0});};fa.prototype.$RequestsJewel24=function(ga,ha){'use strict';o.scry(this.jewel.root,'li.jewelItemNew').forEach(function(ia){n.removeClass(ia,'jewelItemNew');});};fa.prototype.$RequestsJewel6=function(ga,ha){'use strict';this.countNew=ha.count;n.conditionClass(this.jewelFlyout,'beeperUnread',this.countNew>0);n.conditionClass(this.jewelFlyoutCase,'showRequests',this.countNew>0);if(this.newCountSpan){var ia=this.countNew==1?y._("{num} NEW REQUEST",[y.param('num',this.countNew)]):y._({"*":"{num} NEW REQUESTS"},[y.param('num',this.countNew,[0])]);o.setContent(this.newCountSpan,ia);}};fa.prototype.$RequestsJewel20=function(){'use strict';o.scry(this.jewelFlyout,'li.empty').forEach((function(ga){n.conditionShow(ga,this.$RequestsJewel2<=0);}).bind(this));};fa.prototype.$RequestsJewel7=function(){'use strict';j.inform('requestsJewel/opened');var ga=w('fbRequestsJewelLoading'),ha=this.$RequestsJewel23();if(!ga&&!ha){this.unhandledRequest=true;}else if(ga){var ia=Date.now();if(this.openTimestamp+5000<ia){this.openTimestamp=ia;new k().setURI('/ajax/requests/loader/').setData({log_impressions:true}).send();}}else{var ja=Object.keys(this.$RequestsJewel1);if(ja.length>0)new k().setURI('/friends/requests/log_impressions').setData({ids:ja.join(','),ref:'jewel'}).send();}ha&&s.poke(ha);z.onJewelOpened();};fa.prototype.$RequestsJewel5=function(){'use strict';j.inform('requestsJewel/closed');this.$RequestsJewel24();};fa.prototype.$RequestsJewel25=function(){'use strict';return Math.min(Math.max(t.getViewportDimensions().y-ea,da),ca);};fa.prototype.$RequestsJewel13=function(){'use strict';if(this.$RequestsJewel23())new h(this.$RequestsJewel23()).to('height',this.$RequestsJewel25()+'px').duration(100).go();};fa.prototype.setHeight=function(){'use strict';this.$RequestsJewel23().style.height=this.$RequestsJewel25()+'px';};fa.prototype.maybeLoadJewel=function(){'use strict';if(this.unhandledRequest){this.unhandledRequest=false;this.$RequestsJewel7();}};f.exports=fa;},null);
__d('JewelX',['Event','Arbiter','ArbiterMixin','CSS','DOM','HTML','Keys','Promise','TabIsolation','Toggler','Run','csx','emptyFunction','reportData'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();var v=function(w,x){w&&x&&this.init(w,x);};Object.assign(v,{_instancesByName:{}});Object.assign(v.prototype,j,{init:function(w,x){this.name=x.name;this.root=w;this.badge=x.badge;this.countNew=0;this.initialCount=0;this.escHandler=null;this.bootload_module=x.bootload_module;this.bootload_args=x.bootload_args;this.bootloading=null;this.togglerInstance=q.getInstance(w).setSticky(false);r.onAfterLoad((function(){return this._setupBootload();}).bind(this));if(x.keepOpenForSnowlift)this.togglerInstance.setPrePageTransitionCallback(this._onPrePageTransition.bind(this));v._instancesByName[this.name]=this;var y=this.getFlyout(),z=new p(y);q.createInstance(y).setSticky(false);q.listen('show',this.root,(function(aa){this._logFirstClick();this.hasNew()&&this.markSeen();this.reset();i.inform('layer_shown',{type:'Jewel'});z.enable();this.setupEvents();return this._setupBootload().then((function(){this.inform('opened');}).bind(this));}).bind(this));q.listen('hide',this.root,(function(aa,ba){this.hasNew()&&this.markSeen();this.reset();this.inform('closed');i.inform('layer_hidden',{type:'Jewel'});z.disable();this.removeEvents();}).bind(this));i.subscribe('jewel/count-updated',(function(aa,ba){ba.jewel==this.name&&this.update(ba);}).bind(this));i.subscribe('jewel/focus',(function(aa,ba){if(this.isOpen())q.hide(this.root);}).bind(this));},getRoot:function(){return this.root;},getFlyout:function(){if(typeof this._flyout==='undefined')this._flyout=l.find(this.root,".__tw");return this._flyout;},hasNew:function(){return k.hasClass(this.root,'hasNew');},isOpen:function(){return k.hasClass(this.root,'openToggler');},reset:function(){k.removeClass(this.root,'hasNew');},setContent:function(w){var x=l.find(this.root,'ul.jewelItemList');l.setContent(x,m(w));},update:function(w){this.countNew=w.count;if(typeof this.countNew==='number'&&this.countNew<0)this.countNew=0;this.badge.setLegacyContent(this.countNew);var x=isNaN(this.countNew)||this.countNew>0;k.conditionClass(this.root,'hasNew',x);this.inform('updated',w);},setupEvents:function(){this.escHandler=h.listen(document.documentElement,'keydown',(function(w){if(w.keyCode===n.ESC&&this.isOpen())q.hide(this.root);}).bind(this));},removeEvents:function(){if(this.escHandler){this.escHandler.remove();this.escHandler=null;}},markSeen:function(){i.inform('jewel/count-updated',{jewel:this.name,count:0},i.BEHAVIOR_STATE);this.inform('marked-seen');},_onPrePageTransition:function(w,x){if(!this._isSnowliftURI(x.from)&&!this._isSnowliftURI(x.to))this.togglerInstance&&this.togglerInstance.hide();},_isSnowliftURI:function(w){return w&&w.getQueryData().hasOwnProperty('theater');},_logFirstClick:function(){this._logFirstClick=t;u('jewel_click',{gt:{count:this.countNew,initial:this.initialCount,jewel:this.name}});},_setupBootload:function(){if(!this.bootload_module)return o.resolve();if(!this.bootloading)this.bootloading=new o((function(w,x){this.bootload_module.load().then((function(y){new y(this,this.bootload_args);w();}).bind(this))['catch'](x);}).bind(this));return this.bootloading;}});f.exports=v;},null);
__d('ModalMask',['DOM'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=null,j=0,k={show:function(){j++;if(!i){i=h.create('div',{id:'modalMaskOverlay'});h.appendContent(document.body,i);}},hide:function(){if(j){j--;if(!j&&i){h.remove(i);i=null;}}},getNode:function(){return i;}};f.exports=k;},null);
__d('LitestandNewsfeedCountUpdater',['Arbiter','AsyncRequest','LitestandMessages','NavigationMessage','WildWildWestJSGating','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o,p=0;function q(){o&&clearTimeout(o);if(n)return;var u=l.badge_update_time;o=setTimeout(r,u);}function r(){if(n)return;new i().setURI('/ajax/litestand/newsfeed_count').setHandler(function(u){if(n)return;s(u.getPayload());q();}).setAllowCrossPageTransition(true).send();}function s(u){h.inform(j.UPDATE_HOME_COUNT,{count:u,onHome:n},h.BEHAVIOR_STATE);if(l.show_badge_bk){h.inform(k.NAVIGATION_COUNT_UPDATE,{key:'nf',count:n?0:u-p});p=u;}}var t={init:function(){t.init=m;h.subscribe(j.NEWSFEED_LOAD,function(){n=true;s(0);});h.subscribe(j.LEAVE_HOME,function(){n=false;q();});q();}};f.exports=t;},null);
__d('LitestandChromeHomeCount',['Arbiter','CSS','DOM','Event','LitestandMessages','LitestandNewsfeedCountUpdater','Parent','UserAgent_DEPRECATED','csx','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=20,s,t,u,v,w,x={init:function(y){w=y;t=j.find(document,"div._uaw ._5ahz");s=t.parentNode;u=n.byClass(s,"_1ayn");v=false;h.subscribe(l.UPDATE_HOME_COUNT,function(z,aa){x.updateBadge(aa.onHome?0:aa.count);});k.listen(u,'click',function(event){var z=event.getModifiers();if(z.shift||o.osx()&&z.meta||o.windows()&&z.control)x.updateBadge(0);});m.init();x.updateBadge(w);},updateBadge:function(y){w=y;var z=y>0;x.toggleBadge(z);if(z){var aa=y>r?r+'+':y;j.setContent(t,aa);}},toggleBadge:function(y){if(v===y)return;v=y;i.conditionClass(s,"_5ahy",!y);}};f.exports=x;},null);
__d('MercuryJewelModuleLoader',['JSResource'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();f.exports=h('MercuryJewel');},null);
__d("RenderManager",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){"use strict";this._isDirty=false;this._obj=i;}h.prototype.dirty=function(){"use strict";if(!this._isDirty){this._isDirty=true;setTimeout(this._doPaint.bind(this),0);}};h.prototype._doPaint=function(){"use strict";this._isDirty=false;this._obj.paint();};f.exports=h;},null);
__d('CounterDisplay',['Arbiter','CSS','DOM','RenderManager','Run','$','removeFromArray'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();function o(p,q,r,s,t,u){Object.assign(this,{_name:p,_valueNode:m(q),_wrapperNode:m(r)||null,_statusClass:t,_rm:new k(this),_arbiterSubscription:null,_count:0});var v=this._valueNode.firstChild;if(v){var w=parseInt(v.nodeValue,10);if(!isNaN(w))this._count=w;}this._statusNode=s?m(s):null;this._subscribeAll();o.instances.push(this);if(!u)l.onLeave(this._destroy.bind(this),true);}Object.assign(o,{EVENT_TYPE_ADJUST:'CounterDisplay/adjust',EVENT_TYPE_UPDATE:'CounterDisplay/update',instances:[],adjustCount:function(p,q){h.inform(o.EVENT_TYPE_ADJUST+'/'+p,q);},setCount:function(p,q){h.inform(o.EVENT_TYPE_UPDATE+'/'+p,q);}});Object.assign(o.prototype,{_destroy:function(){delete this._valueNode;delete this._wrapperNode;if(this._arbiterSubscription){this._arbiterSubscription.unsubscribe();delete this._arbiterSubscription;}n(o.instances,this);},adjustCount:function(p){this._count=Math.max(0,this._count+p);this._rm.dirty();return this;},setCount:function(p){this._count=Math.max(0,p);this._rm.dirty();return this;},paint:function(){j.setContent(this._valueNode,this._count);this._toggleNodes();},_toggleNodes:function(){if(this._wrapperNode)i.conditionClass(this._wrapperNode,'hidden_elem',this._count<=0);if(this._statusClass&&this._statusNode)i.conditionClass(this._statusNode,this._statusClass,this._count>0);},_subscribeAll:function(){var p=[o.EVENT_TYPE_ADJUST+'/'+this._name,o.EVENT_TYPE_UPDATE+'/'+this._name];this._arbiterSubscription=h.subscribe(p,this._onInform.bind(this),h.SUBSCRIBE_NEW);},_onInform:function(p,q){q=parseInt(q);if(isNaN(q))return;if(p.indexOf(o.EVENT_TYPE_ADJUST)!=-1){this.adjustCount(q);}else if(p.indexOf(o.EVENT_TYPE_UPDATE)!=-1){this.setCount(q);}else return;return;}});f.exports=o;},null);
__d('MessagingEvents',['Arbiter','ChannelConstants','arrayContains','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l={},m=new h();function n(o){if(!k(l))return;for(var p in o)m.inform('count/'+p,o[p]);}m.subscribe('mark-as-read',function(o,p){(p.tids||p.chat_ids||[]).forEach(function(q){q=''+q;if(!(q in l)){l[q]=true;var r=function(){m.unsubscribe(s);clearTimeout(t);delete l[q];},s=m.subscribe('read',function(u,v){if(j(v.tids||[],q)||j(v.chat_ids||[],q))r();}),t=setTimeout(r,60000);}});});h.subscribe(i.getArbiterType('messaging'),function(o,p){var q=babelHelpers._extends({},p.obj),event=q.event||'';delete q.type;delete q.event;m.inform(event,q);if('unread_counts' in q){var r=q.unread_counts;n({unread:r.inbox,other_unseen:r.other});}});h.subscribe(i.getArbiterType('inbox'),function(o,p){var q=babelHelpers._extends({},p.obj);delete q.type;n(q);});b.MessagingEvents=f.exports=m;},3);
__d('TitanLeftNav',['CounterDisplay','MessagingEvents'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={initialize:function(){i.subscribe('count/other_unseen',function(k,l){h.setCount('other_unseen',l);});}};f.exports=j;},null);
__d('AccessibilityShortcut',['AccessibilityLogger','Event','Focus','ge','onEnclosingPageletDestroy','warning'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={init:function(o,p){var q=i.listen(o,'click',function(r){r.preventDefault();var s=k(p);if(s){j.set(s);h.logSRKey();}else m(s,'Failed to set focus on element with ID: %s',p);});l(o,function(){return q.remove();});}};f.exports=n;},null);
__d('NotificationJewelReminderLoader',['JSResource'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();f.exports={init:function(i){h('NotificationJewelReminder').load().done(function(j){new j(i);});}};},null);
__d('PagesVoiceBar',['$','Arbiter','AsyncRequest','BlueBar','ChannelConstants','DOM','URI','ViewportBounds'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p='PagesVoiceBar/initialized',q='PagesVoiceBar/switchVoice',r='page_transition',s='pages_voice_bar_sync',t=null,u=null,v=false,w=false,x=o.addTop(0);function y(ea,fa){new j('/ajax/pages/switch_voice.php').setData(fa).setHandler(function(ga){ca();}).send();}function z(){t=null;}function aa(ea,fa){if(fa.obj.profile_id&&fa.obj.profile_id===t)ca();}function ba(ea){i.subscribe(p,ea);}function ca(){n.getNextURI().go();}var da={initVoiceBar:function(){if(w)return;u=h('pagesVoiceBarContent');i.subscribe(q,y);i.subscribe(r,z);i.subscribe(l.getArbiterType(s),aa);w=true;v=m.contains(k.getBar(),u);i.inform(p,null,i.BEHAVIOR_STATE);},update:function(ea,fa){ba(function(){t=fa;m.setContent(u,ea);var ga=u.offsetHeight;if(!v&&x.getSize()!==ga){x.remove();x=o.addTop(o.getTop()+ga);}});}};f.exports=da;},null);
__d("XPrivacyCheckupSpawnDialogController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/privacy\/checkup\/dialog\/show\/",{source:{type:"Enum",enumType:1}});},null,{});
__d('PrivacyLiteFlyout',['Animation','Arbiter','ArbiterMixin','AsyncDialog','AsyncRequest','Banzai','CSS','DOM','Ease','Event','PrivacyConst','Style','SubscriptionsHandler','Toggler','XPrivacyCheckupSpawnDialogController','XPrivacyRemindersDismissController','csx','cx','ge'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){if(c.__markCompiled)c.__markCompiled();var aa='PrivacyLiteFlyout/expandingSection',ba={},ca={};function da(ja,ka,la){var ma=ka?0:ja.offsetHeight;s.set(ja,'height',ma+'px');s.set(ja,'overflow','hidden');n.show(ja);var na=ka?ja.scrollHeight:0,oa=o.getID(ja);ba[oa]&&ba[oa].stop();ba[oa]=new h(ja).to('height',na).ondone(function(){ba[oa]=null;s.set(ja,'height','');s.set(ja,'overflow','');na||n.hide(ja);la();}).duration(Math.abs(na-ma)*1.5).ease(p.sineOut).go();}function ea(ja){var event='other_section';switch(ja){case 'who_can_see':case 'who_can_contact':case 'how_to_stop':event=ja;break;}return event;}var fa=null,ga=false,ha=false,ia=babelHelpers._extends({loadBody:function(){this._loadBody(false);},loadBodyFromMegaphone:function(){this._loadBody(true);},_loadBody:function(ja){if(!ga&&z('fbPrivacyLiteFlyoutLoading')){ga=true;new l('/ajax/privacy/privacy_lite/loader').setData({from_megaphone:ja}).send();}},_addListener:function(ja,event,ka){return q.listen(ja,'click',function(){m.post('privacy_lite',{event:event,exit_point:ka});});},addLoggingElem:function(ja,event,ka){var la=this._loggingElements.length,ma={elem:ja,event:event,exit:ka};this._loggingElements[la]=ma;},registerSettingsAndBasicsLinkLogging:function(ja,event,ka,la){var ma=o.scry(ja,"._5cw0")[0],na=o.scry(ja,"._3djx")[0];if(ma){this._settingsLinkListener&&this._settingsLinkListener.release();this._settingsLinkListener=this._addListener(ma,event,ka);}if(na){this._privacyBasicsLinkListener&&this._privacyBasicsLinkListener.release();this._privacyBasicsLinkListener=this._addListener(na,event,la);}},_subscribeListeners:function(){this._loggingElements&&this._loggingElements.forEach(function(ja){this._subscriptions&&this._subscriptions.addSubscriptions(this._addListener(ja.elem,ja.event,ja.exit));},this);},renderBody:function(ja,ka){var la=z('fbPrivacyLiteFlyoutLoading');if(la){o.replace(la,ja);ia.registerCallback(function(){ia.inform('load',null,i.BEHAVIOR_STATE);},ka);}},hideCleanup:function(ja){i.inform(aa);var ka=o.scry(ja,"._2va0").forEach(function(la){n.removeClass(la,"_2va0");});},registerFlyoutToggler:function(ja,ka,la){this._loggingElements=[];fa=ka;var ma=u.createInstance(ja);ma.setSticky(false);u.listen(['show','hide'],ka,(function(na){ia.inform(na);ha=na==='show';if(!ha){ia.hideCleanup(ja);ma.hide();this._subscriptions&&this._subscriptions.release();this._subscriptions=null;i.inform('layer_hidden',{type:'PrivacyShortcutsFlyout'});}else{i.inform('layer_shown',{type:'PrivacyShortcutsFlyout'});if(la){la.start(this);la=null;}i.subscribeOnce(aa,(function(){this._subscriptions&&this._subscriptions.release();this._subscriptions=new t();this._subscribeListeners();}).bind(this));m.post('privacy_lite',{event:'show_flyout',exit_point:null});}}).bind(this));},isFlyoutVisible:function(){return fa&&u.getActive()===fa;},exists:function(){return !!o.scry(document.body,"._59fc")[0];},setFlyoutVisible:function(ja){ja?u.show(fa):u.hide(fa);},showSection:function(ja){var ka=ca[ja];if(!ka)return;if(!ka.sublist_container){ia.inform('expanded',ja,i.BEHAVIOR_STATE);return;}var la=ka.chevron,ma=ka.sublist_container;i.inform(aa,la);if(ia.inform('expand',ja)!==false){n.removeClass(la,"_9or");n.addClass(la,"_9os");da(ma,true,function(){ia.inform('expanded',ja);});}},hideSection:function(ja,ka,la){var ma=ca[ja],na=ma.chevron,oa=ma.sublist_container;if(la===na)return;if(ia.inform('collapse',ja)!==false){n.addClass(na,"_9or");n.removeClass(na,"_9os");da(oa,false,function(){ia.inform('collapsed',ja);});}},toggleSection:function(ja){var ka=ca[ja].chevron;u.getInstance(ka).hide();if(n.hasClass(ka,"_9or")){ia.showSection(ja);m.post('privacy_lite',{event:ea(ja)+'_expand',exit_point:null});new l('/ajax/privacy/privacy_lite/log_section_expand').setData({section:ja}).send();}else{ia.hideSection(ja);m.post('privacy_lite',{event:ea(ja)+'_collapse',exit_point:null});}},registerSection:function(ja,ka){ca[ja]=ka;if(ka.sublist_container){i.subscribe(aa,ia.hideSection.bind(null,ja));q.listen(ka.section_block,'click',ia.toggleSection.bind(null,ja));}ia.inform(ja);},registerInlineHelpOnAudienceChangeNewSelector:function(ja,ka,la,ma){ja=ja.getInstance();ja.subscribe('changed',(function(na){this._registerInlineHelpOnAudienceChange(ka,la,ma,ja.getSelectedBaseValue());}).bind(this));},registerSelectorLogging:function(ja,ka,la,ma){ja=ja.getInstance();ja.subscribe('open',function(){m.post('privacy_lite',{event:ka,exit_point:null});});ja.subscribe('close',function(){m.post('privacy_lite',{event:la,exit_point:null});});ja.subscribe('changed',function(){m.post('privacy_lite',{event:ma,exit_point:null});});},_registerInlineHelpOnAudienceChange:function(ja,ka,la,ma){var na=o.find(ja,"._9o_"),oa=o.find(ja,"._2v9_");if(la){var pa=o.find(ja,"._5n9w"),qa=ma==r.BaseValue.EVERYONE;n.conditionShow(pa,qa);n.conditionShow(na,!qa);if(pa&&qa){var ra=w.getURIBuilder().setString('type','delta_everyone').setBool('log_plite',true).getURI();new l(ra).send();}}else n.show(na);n.hide(oa);if(ka)new l('/ajax/privacy/privacy_lite/kill_intro').send();},registerInlineHelpXOutOnClick:function(ja,ka,la){q.listen(ja,'click',function(){n.addClass(ka,"_9p0");});},registerBlockUnhideOnFocus:function(ja,ka){q.listen(ja,'focus',(function(la){n.show(la);m.post('privacy_lite',{event:'block_user_input_click',exit_point:null});}).bind(this,ka));},registerMessageFilterSettingOnClick:function(ja,ka){var la=o.find(ja,"._fv0");q.listen(ja,'click',function(){if(la.checked){new l('/ajax/mercury/change_filtering_type.php').setData({filtering_type:ka,source:'privacy_lite'}).send();}else{var event='basic_filtering';if(ka==='strict')event='strict_filtering';m.post('privacy_lite',{event:event,exit_point:null});}});},registerPrivacyCheckupListener:function(ja){q.listen(ja,'click',(function(){this.setFlyoutVisible(false);k.send(new l(v.getURIBuilder().setEnum('source','plite').getURI()));m.post('privacy_lite',{event:'exit_flyout',exit_point:'privacy_checkup'});}).bind(this));},displayPrivacyCheckup:function(ja){ja.show();}},j);f.exports=ia;},null);
__d('PrivacyLiteFlyoutHelp',['Event','Arbiter','AsyncRequest','Banzai','ContextualHelpSearchController','CSS','DOM','Parent','csx','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r,s;function t(u,v,w,x,y){this._width=315;s=n.find(v,'input');var z=n.create('div');this.init(u,s,z,w,x,{focusSearchBox:false});r=o.byClass(v,"_8-a");h.listen(y,'click',(function(){this._hideSearch(this);k.post('privacy_lite',{event:'plite_search_collapse',exit_point:null});}).bind(this));i.subscribe('PrivacyLiteFlyout/expandingSection',this._hideSearch.bind(this));var aa=n.scry(r,"._d1r")[0];aa&&h.listen(aa,'click',(function(){m.addClass(r,"_aw6");s.focus();k.post('privacy_lite',{event:'plite_search_expand',exit_point:null});if(!this.suggestedResults)new j('/ajax/privacy/privacy_lite/help_suggestions').setHandler((function(ba){var ca=ba.getPayload().searchSuggestions,da=n.find(r,"._4_8m");n.setContent(da,ca);m.addClass(r,"_4_8l");}).bind(this)).send();}).bind(this));}Object.assign(t.prototype,new l(),l.prototype,{source:'privacy_shortcuts',_hideSearch:function(){this.clearResults();m.removeClass(r,"_aw6");},show:function(u){if(u===this.topics_area){m.removeClass(r,"_aw7");return;}else if(u===this.loader){m.addClass(r,"_aw7");m.hide(this.results_area);}else m.hide(this.loader);m.show(u);}});f.exports=t;},null);
__d('ViewasChromeBar',['Event','Arbiter','AsyncRequest','CSS','DOM','Focus','ModalMask','PageTransitionsRegistrar','Parent','cx','csx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s='ViewasChromeBar/initialized',t=null,u=false;function v(y){i.subscribe(s,y);}function w(y){k.addClass(y,"_7g7");var z=l.find(y,"._7g0");m.set(l.find(z,'.textInput'));}var x={initChromeBar:function(y){if(u)return;t=y;u=true;i.inform(s,null,i.BEHAVIOR_STATE);},update:function(y,z){v(function(){l.setContent(t,y);if(z)new j('/ajax/privacy/glasgow/viewas_bar_flyout_open').send();});},registerSpecificModeOnClick:function(y){h.listen(y,'click',w.bind(null,p.byClass(y,"_7f-")));},registerFlyoutModalMask:function(){n.show();o.registerHandler(n.hide,10);}};f.exports=x;},null);