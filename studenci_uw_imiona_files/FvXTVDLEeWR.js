/*!CK:19719942!*//*1446063050,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["Ka269"]); }

__d('legacy:async',['AsyncRequest','AsyncResponse'],function a(b,c,d,e){if(c.__markCompiled)c.__markCompiled();b.AsyncRequest=c('AsyncRequest');b.AsyncResponse=c('AsyncResponse');},3);
__d('ProfileBrowser',['ArbiterMixin','AsyncRequest','CSS','Input','URI','$','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o,p;o=babelHelpers.inherits(q,n(h));p=o&&o.prototype;function q(r,s){'use strict';p.constructor.call(this);this.selectionLimit=s.selectionLimit;this.hubBehaviors=s.hubBehaviors;this.hubsData=s.hubsData;this.typeaheadDataSources=s.typeaheadDataSources;this.listView=r.listView;this.selector=r.selector;this.typeahead=r.typeahead;this.hubs=r.hubsTypeahead;this.initialize(s);this.target=this.listView.getActiveList();this.subscribeListView();this.selector&&this.subscribeSelector();this.typeahead&&this.subscribeTypeahead();this.hubs&&this.subscribeHubs();}q.prototype.initialize=function(r){'use strict';};q.prototype.subscribeListView=function(){'use strict';this.listView.subscribe('clickedCheckable',(function(r,s){this.listView.toggleCheckableItem(s.item,!j.hasClass(s.item,'selectedCheckable'));}).bind(this));};q.prototype.subscribeSelector=function(){'use strict';var r=this.typeahead&&this.typeahead.getCore();this.selector.subscribe('changeTarget',(function(s,t){if(r){j.conditionShow(this.typeahead.getElement(),t.showtypeahead);r.getValue()&&r.reset();t.showtypeahead&&r.getElement().focus();}this.target=m(t.target);t.isprimer&&this.listView.setLoadingState(true);this.listView.swapList(this.target);if(this.typeaheadDataSources&&this.typeaheadDataSources[t.label])this.typeahead.swapData(this.typeaheadDataSources[t.label]);this.hubs&&j.conditionShow(this.hubs.getElement(),t.hubs);}).bind(this));this.selector.subscribe('changeHub',(function(s,t){var u=this.hubs.getCore(),v=u.getElement();this.hubs.init(this.hubBehaviors);this.hubs.swapData(this.hubsData[t.value]);u.reset();k.setPlaceholder(v,t.placeholder);v.focus();this.hubendpoint=new l(t.endpoint);}).bind(this));};q.prototype.subscribeTypeahead=function(){'use strict';this.typeahead.subscribe('render',(function(){var r=this.typeahead.getCore().getValue()?this.typeahead.getView().element:this.target;this.listView.swapList(r);}).bind(this));this.typeahead.subscribe('reset',(function(){this.listView.swapList(this.target);}).bind(this));this.typeahead.subscribe('loading',(function(r,s){j.conditionClass(this.typeahead.getElement(),'loading',s.loading);}).bind(this));};q.prototype.subscribeHubs=function(){'use strict';this.hubs.subscribe('select',(function(r,s){this.hubendpoint.addQueryData({node:s.selected.uid,pagetext:s.selected.text,offset:0,target:this.target.id});j.addClass(this.hubs.getElement(),'hubsLoading');new i(this.hubendpoint).setReadOnly(true).setMethod('POST').setRelativeTo(this.selector.getSelectedAnchor()).setHandler((function(){j.removeClass(this.hubs.getElement(),'hubsLoading');}).bind(this)).send();}).bind(this));};q.prototype.getSelectionLimit=function(){'use strict';return this.selectionLimit;};f.exports=q;},null);
__d('ProfileBrowserListView',['ArbiterMixin','CSS','DOM','Event','Parent','Scroll','Vector','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p,q,r=800;p=babelHelpers.inherits(s,o(h));q=p&&p.prototype;function s(t,u,v){'use strict';q.constructor.call(this);this._root=t;this._activeList=u;this._windowTrigger=v;k.listen(t,'click',this._handleClick.bind(this));}s.prototype.resetScroll=function(){'use strict';this._scroll&&this._scroll.remove();this._listenForScroll();};s.prototype.toggleCheckableItem=function(t,u){'use strict';var v=j.find(t,'input.checkbox');v.checked=u;i.conditionClass(t,'selectedCheckable',u);var w=t.nextSibling||t.previousSibling;w&&i.addClass(w,'sib')&&i.removeClass(w,'sib');};s.prototype.setLoadingState=function(t){'use strict';i.conditionClass(this._root,'showListviewLoading',t);};s.prototype.swapList=function(t){'use strict';i.addClass(this._activeList,'hiddenList');this._activeList=t;i.show(this._activeList);i.removeClass(this._activeList,'hiddenList');};s.prototype.getRoot=function(){'use strict';return this._root;};s.prototype.getActiveList=function(){'use strict';return this._activeList;};s.prototype.setActiveList=function(t){'use strict';this._activeList=t;return this;};s.prototype._handleClick=function(event){'use strict';var t=event.getTarget(),u=l.byClass(t,'checkableListItem');if(!u)return;var v=l.byClass(t,'anchor');if(!v&&l.byTag(t,'a')){this.inform('clickedProfile',{item:u});return;}if(!i.hasClass(u,'disabledCheckable')){v&&event.prevent();this.inform('clickedCheckable',{item:u});event.stop();}};s.prototype._listenForScroll=function(){'use strict';if(this._windowTrigger){this._rootHeight=n.getElementDimensions(this._root).y;if(this._rootHeight)this._scroll=k.listen(window,'scroll',this._handleWindowScroll.bind(this));}else this._scroll=k.listen(this._activeList,'scroll',this._handleListScroll.bind(this));};s.prototype._handleWindowScroll=function(t){'use strict';var u=this._rootHeight-n.getScrollPosition().y;if(u<=r)this.inform('scrollTrigger');};s.prototype._handleListScroll=function(t){'use strict';var u=t.getTarget(),v=u.scrollHeight-m.getTop(u);if(r>v)this.inform('scrollTrigger');};f.exports=s;},null);
__d('ProfileBrowserSelector',['ArbiterMixin','Button','DOM','mixin'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m;l=babelHelpers.inherits(n,k(h));m=l&&l.prototype;function n(o,p){'use strict';m.constructor.call(this);this._buttonElem=o;this._menu=p;p.forEachItem((function(q){if(q.isSelected&&q.isSelected())this._selectedItem=q;}).bind(this));this._menu.subscribe('change',(function(q,r){this.handle(r);}).bind(this));}n.prototype.handle=function(o){'use strict';this._selectedItem=o.item;i.setLabel(this._buttonElem,o.item.getLabel());var p=o.item.getRoot(),q=p.getAttribute('data-selectendpoint'),r=p.getAttribute('data-target');if(r)this.inform('changeTarget',{label:o.label,target:r,value:o.value,isprimer:j.find(p,'a').getAttribute('rel')=='async',showtypeahead:p.getAttribute('data-typeahead'),hubs:!!q});if(q)this.inform('changeHub',{value:o.value,placeholder:p.getAttribute('data-placeholder'),endpoint:q});};n.prototype.getSelectedValue=function(){'use strict';return this._selectedItem.getValue();};n.prototype.getSelectedAnchor=function(){'use strict';return j.find(this._selectedItem.getRoot(),'a');};n.prototype.setSelectedValue=function(o){'use strict';this._menu.setValue(o);};f.exports=n;},null);