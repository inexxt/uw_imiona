/*!CK:4223373436!*//*1446436752,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["vkVNj"]); }

__d('loadImage',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){var k=new Image();k.onload=function(){j(k.width,k.height,k);};k.src=i;}f.exports=h;},null);
__d('PhotoResizeMath',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={getScaledPhotoDimensions:function(i,j,k,l,m){var n=i/j,o=k/l;if(k&&l&&m==='stretch')return {width:k,height:l};if(!k&&l||m==='contain'!==n>=o)return {width:l*n,height:l};if(k)return {width:k,height:k/n};return {width:i,height:j};}};f.exports=h;},null);
__d('PixelzFocus',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={search:function(i,j){var k=0,l=i.length-1;while(k<=l){var m=k+Math.floor((l-k)/2),n=i[m];if(n>j){l=m-1;}else if(n<j){k=m+1;}else return m;}return Math.min(k,l);},forceSpecificPoint:function(i,j,k){var l=1e-09,m=h.search(i,j-k-l)+1,n=h.search(i,j+k);return i.slice(m,n+1);},findBiggestSets:function(i,j){var k=[],l=-1;for(var m=0;m<i.length;++m){var n=i[m],o=m,p=h.search(i,n+j),q=p-o;if(q>l)k=[];if(q>=l){l=q;k.push({low:o,high:p});}}return k;},getBestSet:function(i,j,k){var l=-1,m=null;for(var n=0;n<j.length;++n){var o=j[n],p=i[o.low],q=i[o.high],r=p+(q-p)/2,s=Math.min(p-(r-k),r+k-q);if(s>l){l=s;m=o;}}return m;},getFocusFromSet:function(i,j){var k=i[j.low],l=i[j.high];return k+(l-k)/2;},clampFocus:function(i,j){var k=j/2,l=1-j/2;if(i<k)return k;if(i>l)return l;return i;},convertFromCenterToCSS:function(i,j){if(Math.abs(1-j)<1e-05)return 0;return (i-j/2)/(1-j);},convertFromCSSToCenter:function(i,j){return i*(1-j)+j/2;},getVisible:function(i,j){if(i<j)return i/j;return j/i;},getHidden:function(i,j){return 1-h.getVisible(i,j);},focusHorizontally:function(i,j){return i<j;},convertVectorFromCenterToCSS:function(i,j,k){var l=h.focusHorizontally(j,k),m;if(l){m=i.x/100;}else m=i.x/100;var n=h.convertFromCenterToCSS(m,h.getVisible(j,k));if(l){return {x:n,y:0};}else return {x:0,y:n};},getCropRect:function(i,j,k){var l=h.focusHorizontally(j,k),m=h.getVisible(j,k);if(l){var n=(1-m)*i.x;return {left:n,top:0,width:m,height:1};}else{var o=(1-m)*i.y;return {left:0,top:o,width:1,height:m};}}};f.exports=h;},null);
__d('Pixelz.react',['arrayContains','cx','loadImage','joinClasses','React','PhotoResizeMath','PixelzFocus'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';if(c.__markCompiled)c.__markCompiled();var o=l.PropTypes,p=l.createClass({displayName:'Pixelz',propTypes:{width:o.number,height:o.number,resizeMode:o.oneOf(['contain','cover','stretch']),alt:o.string,letterbox:o.bool,borderRadius:o.number,insetBorderColor:o.string,animated:o.bool,upscale:o.bool,cropRect:function(q,r,s){var t=q[r],u='Invalid prop `'+r+'` supplied to `'+s+'`, expected a rectangle with values normalized '+'between 0 and 1.';if(t.left<0||t.top<0||t.width<0||t.height<0||t.left+t.width>1||t.top+t.height>1)return new Error(u);},focus:function(q,r,s){var t=q[r],u='Invalid prop `'+r+'` supplied to `'+s+'`, expected either a {x, y, type} vector where type '+'is `css` or `center` or an array of {x, y} vectors. All the vectors '+'have with values normalized between 0 and 1.';if(Array.isArray(t)){for(var v=0;v<t.length;++v)if(!(t[v].x>=0&&t[v].x<=1)||!(t[v].y>=0&&t[v].y<=1))return new Error(u);}else{if(!t.type)t.type='css';if(!(t.x>=0&&t.x<=1)||!(t.y>=0&&t.y<=1)||!h(['center','css'],t.type))return new Error(u);}}},getDefaultProps:function(){return {resizeMode:'cover',alt:'',letterbox:true,upscale:true,cropRect:{width:1,height:1,top:0,left:0},focus:{x:.5,y:.5,type:'css'}};},getInitialState:function(){return {srcDimensions:{}};},getSrcDimensions:function(){var q=this.props.src,r=this.state.srcDimensions[q];if(r)return r;j(q,(function(s,t){var u={};u[q]={width:s,height:t};this.isMounted()&&this.setState({srcDimensions:u});}).bind(this));return null;},getCropSrcDimensions:function(){var q=this.getSrcDimensions();return {width:q.width*this.props.cropRect.width,height:q.height*this.props.cropRect.height};},getUpscaleCropDimensions:function(){var q=this.getCropSrcDimensions();return m.getScaledPhotoDimensions(q.width,q.height,this.props.width,this.props.height,this.props.resizeMode);},getCropDimensions:function(){var q=this.getUpscaleCropDimensions(),r=this.getCropSrcDimensions();if(!this.props.upscale)return {width:Math.min(q.width,r.width),height:Math.min(q.height,r.height)};return q;},getCropAspectRatio:function(){var q=this.getCropDimensions();return q.width/q.height;},getContainerDimensions:function(){if(this.props.letterbox&&this.props.width&&this.props.height)return {width:this.props.width,height:this.props.height};return this.getCropDimensions();},getContainerAspectRatio:function(){var q=this.getContainerDimensions();return q.width/q.height;},getContainerPosition:function(){return {left:0,top:0};},getFocus:function(){var q=this.props.focus;if(!Array.isArray(q)&&q.type==='css')return {x:q.x,y:q.y};var r=this.getContainerAspectRatio(),s=this.getCropAspectRatio(),t=n.getVisible(r,s),u=n.focusHorizontally(r,s),v;if(!Array.isArray(q)){v=n.convertFromCenterToCSS(u?q.x:q.y,t);}else{var w=q.map(function(z){return u?z.x:z.y;});w.sort();var x=n.findBiggestSets(w,t),y=n.getBestSet(w,x,t);v=n.getFocusFromSet(w,y);}return {x:u?v:.5,y:u?.5:v};},getCropPosition:function(){var q=this.getCropDimensions(),r=this.getContainerDimensions(),s=this.getFocus();return {left:s.x*(r.width-q.width),top:s.y*(r.height-q.height)};},getScaleDimensions:function(){var q=this.getCropDimensions();return {width:q.width/this.props.cropRect.width,height:q.height/this.props.cropRect.height};},getScalePosition:function(){var q=this.getScaleDimensions();return {left:-q.width*this.props.cropRect.left,top:-q.height*this.props.cropRect.top};},getClipCropRectangle:function(){var q=this.getContainerDimensions(),r=this.getCropDimensions(),s=this.getContainerPosition(),t=this.getCropPosition(),u=Math.max(s.left,t.left),v=Math.max(s.top,t.top),w=Math.min(s.top+q.height,t.top+r.height),x=Math.min(s.left+q.width,t.left+r.width);return {left:u,top:v,width:x-u,height:w-v};},getClipCropPosition:function(){var q=this.getClipCropRectangle();return {left:q.left,top:q.top};},getClipCropDimensions:function(){var q=this.getClipCropRectangle();return {width:q.width,height:q.height};},getClipScalePosition:function(){var q=this.getScalePosition(),r=this.getClipCropPosition(),s=this.getCropPosition();return {left:q.left+(s.left-r.left),top:q.top+(s.top-r.top)};},getClipScaleDimensions:function(){return this.getScaleDimensions();},areDimensionsEqual:function(q,r){return q.width===r.width&&q.height===r.height;},shouldAddAllNodesAndStyles:function(){return this.props.animated;},hasCrop:function(){if(this.shouldAddAllNodesAndStyles())return true;var q=this.getContainerDimensions(),r=this.getClipCropDimensions(),s=this.getClipScaleDimensions();if(this.areDimensionsEqual(q,r)||this.areDimensionsEqual(r,s))return false;return true;},hasContainer:function(){if(this.shouldAddAllNodesAndStyles()||this.hasInsetBorder())return true;var q=this.getContainerDimensions(),r=this.getClipScaleDimensions();if(this.areDimensionsEqual(q,r))return false;return true;},hasInsetBorder:function(){return this.shouldAddAllNodesAndStyles()||this.props.insetBorderColor;},applyPositionStyle:function(q,r){if(this.shouldAddAllNodesAndStyles()||r.left)q.left=Math.round(r.left);if(this.shouldAddAllNodesAndStyles()||r.top)q.top=Math.round(r.top);},applyDimensionsStyle:function(q,r){q.width=Math.round(r.width);q.height=Math.round(r.height);},applyBorderRadiusStyle:function(q){if(this.shouldAddAllNodesAndStyles()||this.props.borderRadius)q.borderRadius=this.props.borderRadius||0;},getScaleStyle:function(){var q={},r=this.getClipCropDimensions(),s=this.getClipScaleDimensions();if(this.shouldAddAllNodesAndStyles()||!this.areDimensionsEqual(r,s)){this.applyPositionStyle(q,this.getClipScalePosition());}else this.applyPositionStyle(q,this.getClipCropPosition());this.applyDimensionsStyle(q,this.getClipScaleDimensions());this.applyBorderRadiusStyle(q);return q;},getCropStyle:function(){var q={};this.applyPositionStyle(q,this.getClipCropPosition());this.applyDimensionsStyle(q,this.getClipCropDimensions());this.applyBorderRadiusStyle(q);return q;},getInsetBorderStyle:function(){var q={borderColor:this.props.insetBorderColor||'transparent'};this.applyPositionStyle(q,this.getClipCropPosition());this.applyDimensionsStyle(q,this.getClipCropDimensions());this.applyBorderRadiusStyle(q);return q;},getContainerStyle:function(){var q={};this.applyDimensionsStyle(q,this.getContainerDimensions());this.applyBorderRadiusStyle(q);return q;},getScale:function(){var q=this.getScaleStyle(),r=q.width,s=q.height;q=babelHelpers._extends({},q);delete q.width;delete q.height;return (l.createElement('img',babelHelpers._extends({},this.props,{alt:this.props.alt,className:k(this.props.className,"_56wb"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),src:this.props.src,style:babelHelpers._extends({},this.props.style||{},q),width:r,height:s})));},getCrop:function(){var q=this.getScale();if(!this.hasCrop())return q;return (l.createElement('div',{className:"_56ma"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":''),style:this.getCropStyle()},q));},getInsetBorder:function(){if(!this.hasInsetBorder())return null;return (l.createElement('div',{className:"_56lv"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":''),style:this.getInsetBorderStyle()}));},getContainer:function(){var q=this.getCrop();if(!this.hasContainer())return q;var r=this.getInsetBorder();return (l.createElement('div',{className:"_56jj"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":''),style:this.getContainerStyle()},q,r));},render:function(){var q=this.getSrcDimensions();if(!q)return l.createElement('span',null);return this.getContainer();}});f.exports=p;},null);
__d('BanzaiScribe',['Banzai'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(k){return {log:function(l,m,n){var o=[m];if(n!=null)o.push(n);h.post('scribe:'+l,o,k);}};}var j=i({});j.create=i;f.exports=j;},null);
__d('TimelineMapScrollableArea',['Animation','ArbiterMixin','CSS','DOM','Event','Run','Scroll','SimpleDrag','Style','Vector','$','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();function t(u,v){u&&this.init(r(u),v);}Object.assign(t.prototype,i,{init:function(u,v){v=v||{};this._elem=u;this._wrap=k.find(u,'div.fbScrollableAreaWrap');this._body=k.find(this._wrap,'div.fbScrollableAreaBody');this._track=k.find(u,'div.fbScrollableAreaTrack');this._gripper=k.find(this._track,'div.fbScrollableAreaGripper');this._options=v;this.adjustGripper();this._listeners=[l.listen(this._wrap,'scroll',this._handleScroll.bind(this))];if(v.fade!==false)this._listeners.push(l.listen(u,'mouseenter',s(this.adjustGripper,this)),l.listen(u,'mouseenter',s(this.showScrollbar,this)),l.listen(u,'mousemove',this._handleMousemove.bind(this)),l.listen(u,'mouseout',s(this.hideScrollbar,this)));if(v.fade!==undefined)this._listeners.push(l.listen(this._track,'click',this.clickToScroll.bind(this)));if(v.verticalscroll)this._listeners.push(l.listen(this._wrap,'mousewheel',this.mouseWheel.bind(this)),l.listen(this._wrap,'DOMMouseScroll',this.mouseWheel.bind(this)));this.initDrag();if(!v.persistent)m.onLeave(this.destroy.bind(this));},getRoot:function(){return this._elem;},initDrag:function(){var u=new o(this._gripper);u.subscribe('start',(function(v,event){if(!(event.which&&event.which===1||event.button&&event.button===1))return;this.inform('dragstart');var w=q.getEventPosition(event).x,x=this._gripper.offsetLeft,y=u.subscribe('update',(function(aa,ba){var ca=q.getEventPosition(ba).x-w,da=this._elem.clientWidth,ea=this._body.offsetWidth,fa=this._track.offsetWidth,ga=da/ea*fa,ha=ea-this._wrap.offsetWidth,ia=x+ca,ja=fa-ga;ia=Math.max(Math.min(ia,ja),0);var ka=ia/ja*ha;n.setLeft(this._wrap,ka);}).bind(this)),z=u.subscribe('end',(function(){u.unsubscribe(y);u.unsubscribe(z);this.inform('dragend');}).bind(this));}).bind(this));},adjustGripper:function(){var u=this._elem.clientWidth,v=this._body.offsetWidth,w=this._track.offsetWidth,x=u/v*w;if(x<w){p.set(this._gripper,'width',x+'px');var y=n.getLeft(this._wrap)/v*w;p.set(this._gripper,'left',y+'px');j.show(this._gripper);}else j.hide(this._gripper);this._checkContentBoundaries();return this;},_checkContentBoundaries:function(){var u=n.getLeft(this._wrap),v=this._wrap.scrollWidth-this._wrap.clientWidth;j.conditionClass(this._elem,'contentBefore',u>0);j.conditionClass(this._elem,'contentAfter',u<v);},destroy:function(){this._listeners.forEach(function(u){u.remove();});this._listeners.length=0;},_handleMousemove:function(event){var u=q.getElementPosition(this._track).y,v=q.getElementDimensions(this._track).y;if(Math.abs(u+v/2-q.getEventPosition(event).y)<25){this.showScrollbar(false);}else this.hideScrollbar();},_handleScroll:function(event){this.adjustGripper();if(this._options.fade!==false)this.showScrollbar();},hideScrollbar:function(){if(!this._scrollbarVisible)return this;this._scrollbarVisible=false;if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null;}this._hideTimeout=setTimeout((function(){if(this._scrollbarAnimation){this._scrollbarAnimation.stop();this._scrollbarAnimation=null;}this._scrollbarAnimation=new h(this._track).from('opacity',1).to('opacity',0).duration(250).ondone(j.addClass.bind(null,this._track,'invisible_elem')).go();}).bind(this),750);return this;},showScrollbar:function(u){if(this._scrollbarVisible)return this;this._scrollbarVisible=true;if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null;}if(this._scrollbarAnimation){this._scrollbarAnimation.stop();this._scrollbarAnimation=null;}this.adjustGripper();p.set(this._track,'opacity',1);j.removeClass(this._track,'invisible_elem');if(u!==false)this.hideScrollbar();return this;},clickToScroll:function(event){var u=q.getEventPosition(event).x,v=this._elem.clientWidth,w=this._body.offsetWidth,x=this._track.offsetWidth,y=v/w*x,z=q.getElementPosition(this._gripper);if(u>=z.x&&u<=z.x+y)return;var aa=u<z.x?-1:1,ba=this._wrap.offsetWidth*.8*aa;this.scrollBy(ba);},scrollBy:function(u){this.setScroll(n.getLeft(this._wrap)+u);},getMaxBodyOffset:function(){return this._body.offsetWidth-this._wrap.offsetWidth;},setScroll:function(u){var v=u;v=Math.max(Math.min(v,this.getMaxBodyOffset()),0);n.setLeft(this._wrap,v);},scrollIntoView:function(u){var v=this._wrap.clientWidth,w=u.offsetWidth,x=n.getLeft(this._wrap),y=x+v,z=u.offsetLeft,aa=z+w;if(z<x||v<w){this.setScroll(z);}else if(aa>y)this.setScroll(x+(aa-y));},mouseWheel:function(event){if(this.getMaxBodyOffset()<=0)return;var u=0;if(event.wheelDelta){var v=event.wheelDelta;if(event.wheelDeltaX&&event.wheelDeltaY)v=Math.abs(event.wheelDeltaX)>Math.abs(event.wheelDeltaY)?event.wheelDeltaX:event.wheelDeltaY;u=-v*10/40;}else if(event.detail)u=event.detail*10;this.scrollBy(u);event.prevent();}});f.exports=b.TimelineMapScrollableArea||t;},null);
__d('WebMessengerDetailViewSearchContextControl',['Event','CSS','DOM','MercuryMessageGroup','WebMessengerMessagesSelection','MercurySearchContextResults','WebMessengerStateConstants','WebMessengerStateManager','WebMessengerTemplates','WebMessengerThreadMessagesRenderer','WebMessengerConstants','fbt','WebMessengerSubscriptionsHandler','MercuryMessages','MercurySearchSnippetResults'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=c('MercuryMessages').get(),v=c('MercurySearchSnippetResults').get();function w(ga,ha,ia){'use strict';this._manager=ga;this._rootElement=ha;this._paginationBox=ia;j.empty(this._rootElement);var ja=p[':fb:web-messenger:read-view:search-context'].build(),ka=p[':fb:web-messenger:read-view:search-pagination-box'].build();j.setContent(this._rootElement,ja.getRoot());j.setContent(this._paginationBox,ka.getRoot());this._messagelistRoot=ja.getRoot();this._loadingSpinner=ja.getNode('loadingSpinner');this._messageList=ja.getNode('messagelist');this._loadMoreButton=ja.getNode('loadMoreButton');this._loadMoreLink=ja.getNode('loadMoreLink');this._downMoreButton=ja.getNode('downMoreButton');this._downMoreLink=ja.getNode('downMoreLink');this._nextSnippet=ka.getNode('nextSnippet');this._previousSnippet=ka.getNode('previousSnippet');this._backToSnippetsButton=ka.getNode('backToSnippetsButton');this._snippetCountDescription=ka.getNode('snippetCountDescription');this._paginationBoxCloseButton=ka.getNode('paginationBoxCloseButton');this._state=null;this._threadID=null;this._messageID=null;q.setupSelectionListener(this._messageList);t.addSubscriptions(h.listen(this._loadMoreLink,'click',(function(){i.addClass(this._loadMoreButton,'async_saving');ea(this,r.MORE_SEARCH_CONTEXT_UP);}).bind(this)),h.listen(this._downMoreLink,'click',(function(){i.addClass(this._downMoreButton,'async_saving');ea(this,r.MORE_SEARCH_CONTEXT_DOWN);}).bind(this)),h.listen(this._nextSnippet,'click',x.bind(null,this,1)),h.listen(this._previousSnippet,'click',x.bind(null,this,-1)),h.listen(this._backToSnippetsButton,'click',function(){var la=o.getCurrentStateData(),ma=la.single_thread_search?n.DETAIL.SEARCH_THREAD_SNIPPET:n.DETAIL.SEARCH_SNIPPET,na={folder:la.folder,message_query:la.message_query,query:la.query};if(la.single_thread_search)na.thread_id=la.thread_id;o.updateDetailState(ma,na);}),h.listen(this._paginationBoxCloseButton,'click',(function(){o.updateDetailState(n.DETAIL.RECENT_MESSAGES,{thread_id:o.getCurrentStateData().thread_id});}).bind(this)));}w.prototype.hideView=function(){'use strict';i.hide(this._rootElement);i.hide(this._paginationBox);};w.prototype.updateView=function(){'use strict';i.show(this._rootElement);i.show(this._paginationBox);var ga=aa(this);ba(this);l.clear();if(ga)da(this);};w.prototype.destroy=function(){'use strict';z(this);};function x(ga,ha){var ia=o.getCurrentStateData(),ja=v.findIndexOfSnippet(ga._messageQuery,ia.thread_id,ia.message_id),ka=ja+ha;i.hide(ga._messageList);i.hide(ga._loadMoreButton);i.hide(ga._downMoreButton);i.show(ga._loadingSpinner);v.findSnippetAtIndex(ga._messageQuery,ia.thread_id,ka,function(la){i.show(ga._messageList);y(ia,la);});}function y(ga,ha){var ia={folder:ga.folder,message_id:ha,message_query:ga.message_query,query:ga.query,single_thread_search:ga.single_thread_search,thread_id:ga.thread_id};o.updateDetailState(o.getCurrentDetailState(),ia);}function z(ga){ga._searchContextSubscription&&m.unsubscribe(ga._searchContextSubscription.subscriber_id,ga._searchContextSubscription.message_id,ga._searchContextSubscription.direction);ga._searchThreadsSubscription=null;}function aa(ga){var ha=o.getCurrentStateData();if(ga._threadID!=ha.thread_id)return true;if(ga._messageQuery!=ha.message_query)return true;if(ga._messageID!=ha.message_id)return true;return false;}function ba(ga){var ha=o.getCurrentStateData();ga._state=o.getCurrentDetailState();ga._threadID=ha.thread_id;ga._messageQuery=ha.message_query;ga._messageID=ha.message_id;ga._selectionEnabled=!!ha.message_action;q.updateSelection(ga._messageList);i.conditionClass(ga._messageList,'bugReportingEnabled',ha.bug_reporting_enabled);}function ca(ga,ha){j.setAttributes(ga,{disabled:ha});var ia=j.find(ga,'^label');i.conditionClass(ia,'uiButtonDisabled',ha);}function da(ga){var ha=j.create('strong',{},ga._messageQuery),ia=v.countSnippetsMatchingQueryInThread(ga._messageQuery,ga._threadID),ja=v.findIndexOfSnippet(ga._messageQuery,ga._threadID,ga._messageID),ka=ja+1,la=s._({"*":"{index} of {count} results for {query}"},[s.param('index',ka),s.param('count',ia,[0]),s.param('query',ha)]);j.setContent(ga._snippetCountDescription,la);ca(ga._previousSnippet,ja===0);ca(ga._nextSnippet,ja===ia-1);j.empty(ga._messageList);i.show(ga._loadingSpinner);i.hide(ga._loadMoreButton);i.hide(ga._downMoreButton);z(ga);if(ga._threadID&&ga._messageID){var ma=m.getSearchContext(ga._messageID,ga._threadID,function(na){i.hide(ga._loadingSpinner);fa(ga,na);});if(ma)ga._searchContextSubscription={subscriber_id:ma,message_id:ga._messageID};}}function ea(ga,ha){z(ga);if(ga._threadID&&ga._messageID){var ia=m.getMoreSearchContext(ga._messageID,ga._threadID,ha,function(ja){if(ha==r.MORE_SEARCH_CONTEXT_UP){i.removeClass(ga._loadMoreButton,'async_saving');}else i.removeClass(ga._downMoreButton,'async_saving');fa(ga,ja);});if(ia)ga._searchContextSubscription={subscriber_id:ia,message_id:ga._messageID,direction:ha};}}function fa(ga,ha){i.conditionShow(ga._loadMoreButton,!ha.up_exhausted);i.conditionShow(ga._downMoreButton,!ha.down_exhausted);var ia=ha.up_message_ids.concat([ha.message_id],ha.down_message_ids),ja=u.getMessagesFromIDs(ia);j.empty(ga._messageList);var ka=k.calculateMessageGroups(ja);ka.forEach(function(la,ma){var na=q.renderMessageSeparatorForIndex(ka,ma);if(na)j.appendContent(ga._messageList,na);var oa=q.renderMessageGroup(la,false,'context:').getRoot(),pa=la.some(function(qa){return qa.message_id==ha.message_id;});if(pa)i.addClass(oa,'selectedHighlight');j.appendContent(ga._messageList,oa);});}f.exports=w;},null);
__d('SamplingPolicyBase',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(){'use strict';throw 'Tried to instantiate SamplingPolicyBase';}h.prototype.getName=function(){'use strict';return this.name;};h.prototype.isSampled=function(){'use strict';if(typeof this.sampled=='undefined')this.sampled=this.decideIfSampled();return this.sampled;};f.exports=h;},null);
__d('FbtraceForcedByServerPolicy',['FbtraceForcedByServer','SamplingPolicyBase'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j;function k(){this.name='FbtraceForcedByServerPolicy';}k.get=function(){if(typeof j=='undefined')j=new k();return j;};function l(){return h.forced;}Object.assign(k.prototype,i.prototype,{decideIfSampled:l});f.exports=k;},null);
__d("guardFunction",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j,k){return function(){if(i.apply(k||this,arguments))j.apply(k||this,arguments);};}f.exports=h;},null);
__d('Fbtrace',['Arbiter','BanzaiScribe','ErrorUtils','FbtraceForcedByServer','FbtraceForcedByServerPolicy','Random','SiteData','guardFunction'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p,q;'use strict';var r='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',s='AAAAAAAAAAA';p=babelHelpers.inherits(t,Error);q=p&&p.prototype;function t(ia){q.constructor.call(this,ia);}function u(ia){j.reportError(new t(ia));}function v(){var ia=function(){var la=0,ma=0,na='';for(var oa=10;oa>=0;oa--){if(la<6){ma=m.uint32();la=32;}if(oa===0)ma=ma&7;na=r.charAt(ma&63)+na;ma>>=6;la-=6;}return na;},ja,ka;for(ja=3;ja>0;ja--){ka=ia();if(ka!=s)return ka;}u('failed to generate valid Fbtrace id');return s;}function w(){Object.assign(this,w);}Object.assign(w,{isOn:function(){return false;},replySend:function(ia,ja){},requestSend:function(ia,ja,ka){ca(ia,ja);return {metadata:function(){return undefined;},replyReceive:function(la){}};}});var x=new w();function y(ia,ja,ka){if(!ia)throw {name:'ArgumentError',message:'no valid service name specified'};if(!ja)throw {name:'ArgumentError',message:'no valid version specified'};var la=i,ma=0,na=v(),oa=v(),pa=ba(na),qa={service:ia,version:ja},ra=function(wa){if(typeof wa=='undefined')return 'undefined';if(typeof wa!='string')wa=ra(JSON.stringify(wa));return wa;},sa=function(wa){var xa='';for(var ya in wa){if(xa.length>0)xa+='\x02';xa+=ra(ya)+'\x03'+ra(wa[ya]);}return xa;},ta=function(wa,xa,event,ya,za){ma++;return [za,ma,na,wa,xa,ra(event),sa(ya)].join('\x01');},ua=function(wa,xa,event,ya,za){if(!za&&typeof za=='undefined')za=Date.now()*1000;var ab=ta(wa,xa,event,ya,za);la.log('fbtrace',ab,pa);},va=function(){return oa;};ua(s,oa,'#rqrecv',Object.assign(ka||{},qa));Object.assign(this,y,{replySend:function(wa,xa){xa=babelHelpers._extends({},xa,qa,{success:wa?'true':'false'});ua(s,oa,'#rpsend',xa);},requestSend:function(wa,xa,ya){ca(wa,xa);var za=va(),ab=v();ya=babelHelpers._extends({},ya,qa,{op:wa,'remote:service':xa});ua(za,ab,'#rqsend',ya);return {metadata:function(){return na+ab;},replyReceive:function(bb){ua(za,ab,'#rprecv',Object.assign(bb||{},qa));},parentNode:this};}});}Object.assign(y,{isOn:function(){return true;}});function z(){return x;}function aa(ia,ja,ka){ka=ka||{};ka.init=true;var la=l.get();if(la.isSampled()){return new y(ia,ja,ka);}else return new w();}function ba(ia){var ja=ia.charAt(ia.length-1);return r.indexOf(ja)%32;}function ca(ia,ja){if(!ia)throw {name:'ArgumentError',message:'no valid operation specified'};if(!ja)throw {name:'ArgumentError',message:'no valid remote:service specified'};}function da(ia,ja){var ka=x,la;x=ia;try{la=ja();}finally{x=ka;}return la;}var ea=function(ia,ja){var ka=z(),la=ja.request,ma=false;if(!ka.isOn()&&k.forced&&/\/upload\/(?:composer|photos)\/|\/ajax\/composerx\/attachment\/media\//.test(la.uri.toString())){ka=aa('photo_upload_kludge',String(n.revision||'dev'),{policy:'PhotoUpload'});ma=true;}if(ka.isOn()){var na=ma?{policy:'PhotoUpload'}:{};if(la.userActionId)na.user_action_id=la.userActionId;var oa=ka.requestSend(la.uri.toString(),'www',na);la.fbtraceRemoteNode=oa;la.transport.setRequestHeader('X-Fbtrace-Meta',oa.metadata());}},fa=function(ia,ja){ja.request.fbtraceRemoteNode.replyReceive({is_last:ja.response.is_last,success:true});setTimeout(function(){ja.request.fbtraceRemoteNode.parentNode.replySend(true,{});},0);},ga=function(ia,ja){ja.request.fbtraceRemoteNode.replyReceive({is_last:ja.response.is_last,success:false,error_code:ja.response.error,error_summary:ja.response.errorSummary,error_description:ja.response.errorDescription});setTimeout(function(){ja.request.fbtraceRemoteNode.parentNode.replySend(false,{});},0);},ha=function(ia,ja){return ja.request.fbtraceRemoteNode;};h.subscribe('AsyncRequest/will_send',ea);h.subscribe('AsyncRequest/response',o(ha,fa));h.subscribe('AsyncRequest/error',o(ha,ga));f.exports={defaultNode:z,requestReceive:aa,withDefaultNode:da};},null);
__d('FileFormResetOnSubmit',['DOMQuery','Event','emptyFunction'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(m,n){var o=i.listen(m,'change',j.thatReturnsFalse,i.Priority.URGENT);try{n();}catch(p){throw p;}finally{o.remove();}}function l(m){'use strict';this._form=m;}l.prototype.enable=function(){'use strict';var m=this._reset.bind(this);this._subscription=this._form.subscribe('submit',function(){setTimeout(m,0);});};l.prototype.disable=function(){'use strict';this._subscription.unsubscribe();this._subscription=null;};l.prototype._reset=function(){'use strict';var m=this._form.getRoot();k(m,function(){var n=h.scry(m,'input[type="file"]');n.forEach(function(o){o.value='';});});};f.exports=l;},null);
__d('StickersFlyoutPackSelector.react',['Animation','ImmutableObject','Locale','React','ReactDOM','Image.react','StickerActions','StickerConfig','StickerConstants','StickerInterfaces','StickerState','StickerStoreController','XUIBadge.react','cx','emptyFunction','fbt','ix','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){'use strict';if(c.__markCompiled)c.__markCompiled();var z=k.PropTypes,aa=4,ba=200,ca=w._("Sticker Store"),da=k.createClass({displayName:'StickersFlyoutPackSelector',propTypes:{stickerInterface:z.oneOf(y(q)),numNewPacks:z.number,packs:z.arrayOf(z.instanceOf(i)).isRequired,onPackClick:z.func,selectedPackID:z.string,resetTagSelectorFunc:z.func},getInitialState:function(){return {animating:false,page:0};},getDefaultProps:function(){return {stickerInterface:q.MESSAGES,numNewPacks:0};},shouldComponentUpdate:function(fa,ga){return !ga.animating;},onFlyoutShown:function(){if(this.props.packs.length>0){var fa=this._calculatePageForPack(this.props.selectedPackID);if(this.state.page!==fa)this._setPage(fa,0);}},_calculatePageForPack:function(fa){for(var ga=0;ga<this.props.packs.length;ga++)if(this.props.packs[ga].id==fa)return ga<=aa?0:Math.floor((ga-1)/aa);return 0;},_setPage:function(fa,ga){if(this.state.animating)return;this.setState({animating:true,page:fa},function(){var ha=l.findDOMNode(this.refs.positioner),ia=this._calculatePosition(fa);new h(ha).to(ia.reference,ia.offset+'px').ondone((function(){return this.setState({animating:false});}).bind(this)).duration(ga).go();});},_calculatePosition:function(fa){var ga=l.findDOMNode(this.refs.positioner),ha=ga.childNodes[fa].offsetLeft;if(j.isRTL()){var ia=ga.offsetWidth,ja=ga.childNodes[fa].offsetWidth;return {reference:'right',offset:ha+ja-ia};}return {reference:'left',offset:-ha};},_numPages:function(){return Math.max(1,Math.ceil((this.props.packs.length-1)/aa));},_canGoPrev:function(){return this.state.page>0;},_canGoNext:function(){return this.state.page+1<this._numPages();},_goPrev:function(){this._canGoPrev()&&this._setPage(this.state.page-1,ba);},_goNext:function(){this._canGoNext()&&this._setPage(this.state.page+1,ba);},_openStore:function(){n.resetNumNewPacks();var fa=this.props.stickerInterface==q.COMPOSER;s.showStore(null,fa);},render:function(){return (k.createElement('div',{className:"_5r85"},this._renderStoreButton(),this._renderPrevArrow(),this._renderNextArrow(),k.createElement('div',{className:"_5r88"},k.createElement('div',{className:"_5r89",ref:'positioner'},this._renderPages()))));},_selectPack:function(fa){var ga=r.getPack(fa);if(ga&&ga.isPromoted)n.addPack(fa);if(fa===p.SEARCH_PACK_ID)this.props.resetTagSelectorFunc();n.selectPack(fa);},_renderPages:function(){var fa=this.props.packs.map((function(ja,ka){return (k.createElement(ea,{key:ja.id,onClick:(function(){return this._selectPack(ja.id);}).bind(this),pack:ja,selected:this.props.selectedPackID===ja.id,index:ka,isComments:this.props.stickerInterface==q.COMMENTS}));}).bind(this)),ga=[];for(var ha=0;ha<fa.length;ha+=aa){var ia=ha;ha===0&&ha++;ga.push(k.createElement('div',{className:"_5r81",key:ha},fa.slice(ia,ha+aa)));}return ga;},_renderStoreButton:function(){return (k.createElement('a',{'aria-label':ca,className:"_5r86 rfloat",'data-hover':'tooltip',onClick:this._openStore},k.createElement(m,{className:"_5r87",src:x('/images/messaging/stickers/selector/sticker_store.png')}),this._renderJewel()));},_renderJewel:function(){var fa=this.props.numNewPacks;if(!fa)return null;return (k.createElement(t,{className:"rfloat _3fhs",count:fa,maxcount:9,type:'special'}));},_renderPrevArrow:function(){if(!this._canGoPrev())return null;var fa=j.isRTL()?x('/images/messaging/stickers/selector/right.png'):x('/images/messaging/stickers/selector/left.png');return (k.createElement('a',{className:"_37wu"+(' '+"lfloat"),onClick:this._goPrev},k.createElement(m,{className:"_5r84",src:fa})));},_renderNextArrow:function(){if(!this._canGoNext())return null;var fa=j.isRTL()?x('/images/messaging/stickers/selector/left.png'):x('/images/messaging/stickers/selector/right.png');return (k.createElement('a',{className:"_37wv"+(' '+"rfloat"),onClick:this._goNext},k.createElement(m,{className:"_5r84",src:fa})));}}),ea=k.createClass({displayName:'PackIcon',propTypes:{index:z.number,isComments:z.bool,onClick:z.func,pack:z.instanceOf(i).isRequired,selected:z.bool},getDefaultProps:function(){return {isComments:false,onClick:v};},_getPackIcon:function(fa){if(fa.id==p.SEARCH_PACK_ID)return x('/images/messaging/stickers/icons/search.png');if(fa.id==p.MRU_STICKER_PACK)return x('/images/messaging/stickers/icons/recent.png');if(fa.id==p.EMOTICON_PACK_ID)return x('/images/messaging/stickers/icons/emoji.png');return fa.icon;},render:function(){var fa=this.props.pack,ga=o.WebStickerSearch?this.props.index===1||this.props.index===2:this.props.index===1,ha="_5r8a"+(this.props.selected?' '+"_5r8b":'')+(fa.id==p.MRU_STICKER_PACK?' '+"_5qcj":'')+(fa.id==p.SEARCH_PACK_ID?' '+"_5qck":'')+(ga?' '+"_eb3":''),ia=this.props.isComments&&!fa.isCommentsCapable,ja=w._("This pack is only available in photos"),ka=w._("This pack is only available in messages"),la=ia?v:(function(){return this.props.onClick(fa.id);}).bind(this),ma=this._getPackIcon(fa);if(ma===null)return null;var na=ka;if(!fa.isMessengerCapable&&fa.isComposerCapable)na=ja;return (k.createElement('a',{'aria-label':ia?na:fa.name,className:ha,'data-id':fa.id,'data-hover':'tooltip',ref:'search_icon',onClick:la,tabIndex:'0'},k.createElement(m,{className:(ia?"_2ji6":'')+(' '+"_5r8c")+(o.WebStickerSearch?' '+"_1viy":''),src:ma})));}});f.exports=da;},null);
__d('FormSubmitOnChange',['Event','submitForm'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';this._form=k;}j.prototype.enable=function(){'use strict';this._listener=h.listen(this._form.getRoot(),'change',this._submit.bind(this));};j.prototype.disable=function(){'use strict';this._listener.remove();this._listener=null;};j.prototype._submit=function(){'use strict';i(this._form.getRoot());};Object.assign(j.prototype,{_listener:null});f.exports=j;},null);